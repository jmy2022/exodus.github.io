(self.webpackChunkexodus_react=self.webpackChunkexodus_react||[]).push([[35],{88484:function(ct,de,E){"use strict";E.d(de,{Z:function(){return me}});var F=E(1413),L=E(67294),A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},j=A,W=E(91146),oe=function(te,ae){return L.createElement(W.Z,(0,F.Z)((0,F.Z)({},te),{},{ref:ae,icon:j}))};oe.displayName="UploadOutlined";var me=L.forwardRef(oe)},66476:function(ct,de,E){"use strict";E.d(de,{Z:function(){return mn}});var F=E(67294),L=E(74902),A=E(94184),j=E.n(A),W=E(87462),oe=E(15671),me=E(43144),ie=E(32531),te=E(73568),ae=E(4942),Ze=E(91),He=E(74165),Ve=E(71002),ve=E(15861),T=E(64217);function C(c,g){var m="cannot ".concat(c.method," ").concat(c.action," ").concat(g.status,"'"),b=new Error(m);return b.status=g.status,b.method=c.method,b.url=c.action,b}function v(c){var g=c.responseText||c.response;if(!g)return g;try{return JSON.parse(g)}catch(m){return g}}function u(c){var g=new XMLHttpRequest;c.onProgress&&g.upload&&(g.upload.onprogress=function(x){x.total>0&&(x.percent=x.loaded/x.total*100),c.onProgress(x)});var m=new FormData;c.data&&Object.keys(c.data).forEach(function(I){var x=c.data[I];if(Array.isArray(x)){x.forEach(function(S){m.append("".concat(I,"[]"),S)});return}m.append(I,x)}),c.file instanceof Blob?m.append(c.filename,c.file,c.file.name):m.append(c.filename,c.file),g.onerror=function(x){c.onError(x)},g.onload=function(){return g.status<200||g.status>=300?c.onError(C(c,g),v(g)):c.onSuccess(v(g),g)},g.open(c.method,c.action,!0),c.withCredentials&&"withCredentials"in g&&(g.withCredentials=!0);var b=c.headers||{};return b["X-Requested-With"]!==null&&g.setRequestHeader("X-Requested-With","XMLHttpRequest"),Object.keys(b).forEach(function(I){b[I]!==null&&g.setRequestHeader(I,b[I])}),g.send(m),{abort:function(){g.abort()}}}var s=+new Date,f=0;function d(){return"rc-upload-".concat(s,"-").concat(++f)}var q=E(80334),V=function(c,g){if(c&&g){var m=Array.isArray(g)?g:g.split(","),b=c.name||"",I=c.type||"",x=I.replace(/\/.*$/,"");return m.some(function(S){var w=S.trim();if(/^\*(\/\*)?$/.test(S))return!0;if(w.charAt(0)==="."){var r=b.toLowerCase(),t=w.toLowerCase(),e=[t];return(t===".jpg"||t===".jpeg")&&(e=[".jpg",".jpeg"]),e.some(function(o){return r.endsWith(o)})}return/\/\*$/.test(w)?x===w.replace(/\/.*$/,""):I===w?!0:/^\w+$/.test(w)?((0,q.ZP)(!1,"Upload takes an invalidate 'accept' type '".concat(w,"'.Skip for check.")),!0):!1})}return!0};function ne(c,g){var m=c.createReader(),b=[];function I(){m.readEntries(function(x){var S=Array.prototype.slice.apply(x);b=b.concat(S);var w=!S.length;w?g(b):I()})}I()}var Be=function(g,m,b){var I=function x(S,w){S.path=w||"",S.isFile?S.file(function(r){b(r)&&(S.fullPath&&!r.webkitRelativePath&&(Object.defineProperties(r,{webkitRelativePath:{writable:!0}}),r.webkitRelativePath=S.fullPath.replace(/^\//,""),Object.defineProperties(r,{webkitRelativePath:{writable:!1}})),m([r]))}):S.isDirectory&&ne(S,function(r){r.forEach(function(t){x(t,"".concat(w).concat(S.name,"/"))})})};g.forEach(function(x){I(x.webkitGetAsEntry())})},Ot=Be,Et=["component","prefixCls","className","disabled","id","style","multiple","accept","capture","children","directory","openFileDialogOnClick","onMouseEnter","onMouseLeave"],Ut=function(c){(0,ie.Z)(m,c);var g=(0,te.Z)(m);function m(){var b;(0,oe.Z)(this,m);for(var I=arguments.length,x=new Array(I),S=0;S<I;S++)x[S]=arguments[S];return b=g.call.apply(g,[this].concat(x)),b.state={uid:d()},b.reqs={},b.fileInput=void 0,b._isMounted=void 0,b.onChange=function(w){var r=b.props,t=r.accept,e=r.directory,o=w.target.files,i=(0,L.Z)(o).filter(function(n){return!e||V(n,t)});b.uploadFiles(i),b.reset()},b.onClick=function(w){var r=b.fileInput;if(r){var t=b.props,e=t.children,o=t.onClick;if(e&&e.type==="button"){var i=r.parentNode;i.focus(),i.querySelector("button").blur()}r.click(),o&&o(w)}},b.onKeyDown=function(w){w.key==="Enter"&&b.onClick(w)},b.onFileDrop=function(w){var r=b.props.multiple;if(w.preventDefault(),w.type!=="dragover")if(b.props.directory)Ot(Array.prototype.slice.call(w.dataTransfer.items),b.uploadFiles,function(e){return V(e,b.props.accept)});else{var t=(0,L.Z)(w.dataTransfer.files).filter(function(e){return V(e,b.props.accept)});r===!1&&(t=t.slice(0,1)),b.uploadFiles(t)}},b.uploadFiles=function(w){var r=(0,L.Z)(w),t=r.map(function(e){return e.uid=d(),b.processFile(e,r)});Promise.all(t).then(function(e){var o=b.props.onBatchStart;o==null||o(e.map(function(i){var n=i.origin,l=i.parsedFile;return{file:n,parsedFile:l}})),e.filter(function(i){return i.parsedFile!==null}).forEach(function(i){b.post(i)})})},b.processFile=function(){var w=(0,ve.Z)((0,He.Z)().mark(function r(t,e){var o,i,n,l,h,y,a,p,$;return(0,He.Z)().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(o=b.props.beforeUpload,i=t,!o){O.next=14;break}return O.prev=3,O.next=6,o(t,e);case 6:i=O.sent,O.next=12;break;case 9:O.prev=9,O.t0=O.catch(3),i=!1;case 12:if(i!==!1){O.next=14;break}return O.abrupt("return",{origin:t,parsedFile:null,action:null,data:null});case 14:if(n=b.props.action,typeof n!="function"){O.next=21;break}return O.next=18,n(t);case 18:l=O.sent,O.next=22;break;case 21:l=n;case 22:if(h=b.props.data,typeof h!="function"){O.next=29;break}return O.next=26,h(t);case 26:y=O.sent,O.next=30;break;case 29:y=h;case 30:return a=((0,Ve.Z)(i)==="object"||typeof i=="string")&&i?i:t,a instanceof File?p=a:p=new File([a],t.name,{type:t.type}),$=p,$.uid=t.uid,O.abrupt("return",{origin:t,data:y,parsedFile:$,action:l});case 35:case"end":return O.stop()}},r,null,[[3,9]])}));return function(r,t){return w.apply(this,arguments)}}(),b.saveFileInput=function(w){b.fileInput=w},b}return(0,me.Z)(m,[{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentWillUnmount",value:function(){this._isMounted=!1,this.abort()}},{key:"post",value:function(I){var x=this,S=I.data,w=I.origin,r=I.action,t=I.parsedFile;if(this._isMounted){var e=this.props,o=e.onStart,i=e.customRequest,n=e.name,l=e.headers,h=e.withCredentials,y=e.method,a=w.uid,p=i||u,$={action:r,filename:n,data:S,file:t,headers:l,withCredentials:h,method:y||"post",onProgress:function(O){var M=x.props.onProgress;M==null||M(O,t)},onSuccess:function(O,M){var B=x.props.onSuccess;B==null||B(O,t,M),delete x.reqs[a]},onError:function(O,M){var B=x.props.onError;B==null||B(O,M,t),delete x.reqs[a]}};o(w),this.reqs[a]=p($)}}},{key:"reset",value:function(){this.setState({uid:d()})}},{key:"abort",value:function(I){var x=this.reqs;if(I){var S=I.uid?I.uid:I;x[S]&&x[S].abort&&x[S].abort(),delete x[S]}else Object.keys(x).forEach(function(w){x[w]&&x[w].abort&&x[w].abort(),delete x[w]})}},{key:"render",value:function(){var I,x=this.props,S=x.component,w=x.prefixCls,r=x.className,t=x.disabled,e=x.id,o=x.style,i=x.multiple,n=x.accept,l=x.capture,h=x.children,y=x.directory,a=x.openFileDialogOnClick,p=x.onMouseEnter,$=x.onMouseLeave,U=(0,Ze.Z)(x,Et),O=j()((I={},(0,ae.Z)(I,w,!0),(0,ae.Z)(I,"".concat(w,"-disabled"),t),(0,ae.Z)(I,r,r),I)),M=y?{directory:"directory",webkitdirectory:"webkitdirectory"}:{},B=t?{}:{onClick:a?this.onClick:function(){},onKeyDown:a?this.onKeyDown:function(){},onMouseEnter:p,onMouseLeave:$,onDrop:this.onFileDrop,onDragOver:this.onFileDrop,tabIndex:"0"};return F.createElement(S,(0,W.Z)({},B,{className:O,role:"button",style:o}),F.createElement("input",(0,W.Z)({},(0,T.Z)(U,{aria:!0,data:!0}),{id:e,type:"file",ref:this.saveFileInput,onClick:function(K){return K.stopPropagation()},key:this.state.uid,style:{display:"none"},accept:n},M,{multiple:i,onChange:this.onChange},l!=null?{capture:l}:{})),h)}}]),m}(F.Component),Rt=Ut;function Ie(){}var dt=function(c){(0,ie.Z)(m,c);var g=(0,te.Z)(m);function m(){var b;(0,oe.Z)(this,m);for(var I=arguments.length,x=new Array(I),S=0;S<I;S++)x[S]=arguments[S];return b=g.call.apply(g,[this].concat(x)),b.uploader=void 0,b.saveUploader=function(w){b.uploader=w},b}return(0,me.Z)(m,[{key:"abort",value:function(I){this.uploader.abort(I)}},{key:"render",value:function(){return F.createElement(Rt,(0,W.Z)({},this.props,{ref:this.saveUploader}))}}]),m}(F.Component);dt.defaultProps={component:"span",prefixCls:"rc-upload",data:{},headers:{},name:"file",multipart:!1,onStart:Ie,onError:Ie,onSuccess:Ie,multiple:!1,beforeUpload:null,customRequest:null,withCredentials:!1,openFileDialogOnClick:!0};var Ne=dt,ft=Ne,Pt=E(21770),qe=E(73935),Xe=E(53124),At=E(98866),Fe=E(10110),Lt=E(24457),Dt={icon:function(g,m){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M534 352V136H232v752h560V394H576a42 42 0 01-42-42z",fill:m}},{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM602 137.8L790.2 326H602V137.8zM792 888H232V136h302v216a42 42 0 0042 42h216v494z",fill:g}}]}},name:"file",theme:"twotone"},Ge=Dt,$e=E(93771),se=function(g,m){return F.createElement($e.Z,(0,W.Z)({},g,{ref:m,icon:Ge}))},ye=F.forwardRef(se),ht=E(19267),Tt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z"}}]},name:"paper-clip",theme:"outlined"},fe=Tt,pt=function(g,m){return F.createElement($e.Z,(0,W.Z)({},g,{ref:m,icon:fe}))},gt=F.forwardRef(pt),mt={icon:function(g,m){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136v-39.9l138.5-164.3 150.1 178L658.1 489 888 761.6V792zm0-129.8L664.2 396.8c-3.2-3.8-9-3.8-12.2 0L424.6 666.4l-144-170.7c-3.2-3.8-9-3.8-12.2 0L136 652.7V232h752v430.2z",fill:g}},{tag:"path",attrs:{d:"M424.6 765.8l-150.1-178L136 752.1V792h752v-30.4L658.1 489z",fill:m}},{tag:"path",attrs:{d:"M136 652.7l132.4-157c3.2-3.8 9-3.8 12.2 0l144 170.7L652 396.8c3.2-3.8 9-3.8 12.2 0L888 662.2V232H136v420.7zM304 280a88 88 0 110 176 88 88 0 010-176z",fill:m}},{tag:"path",attrs:{d:"M276 368a28 28 0 1056 0 28 28 0 10-56 0z",fill:m}},{tag:"path",attrs:{d:"M304 456a88 88 0 100-176 88 88 0 000 176zm0-116c15.5 0 28 12.5 28 28s-12.5 28-28 28-28-12.5-28-28 12.5-28 28-28z",fill:g}}]}},name:"picture",theme:"twotone"},We=mt,zt=function(g,m){return F.createElement($e.Z,(0,W.Z)({},g,{ref:m,icon:We}))},jt=F.forwardRef(zt),Ke=E(82225),ln=E(57838),Mt=E(33603),Je=E(96159),Oe=E(71577);function Ee(c){return Object.assign(Object.assign({},c),{lastModified:c.lastModified,lastModifiedDate:c.lastModifiedDate,name:c.name,size:c.size,type:c.type,uid:c.uid,percent:0,originFileObj:c})}function Ue(c,g){const m=(0,L.Z)(g),b=m.findIndex(I=>{let{uid:x}=I;return x===c.uid});return b===-1?m.push(c):m[b]=c,m}function Ye(c,g){const m=c.uid!==void 0?"uid":"name";return g.filter(b=>b[m]===c[m])[0]}function Ht(c,g){const m=c.uid!==void 0?"uid":"name",b=g.filter(I=>I[m]!==c[m]);return b.length===g.length?null:b}const Bt=function(){const g=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"").split("/"),b=g[g.length-1].split(/#|\?/)[0];return(/\.[^./\\]*$/.exec(b)||[""])[0]},Qe=c=>c.indexOf("image/")===0,Nt=c=>{if(c.type&&!c.thumbUrl)return Qe(c.type);const g=c.thumbUrl||c.url||"",m=Bt(g);return/^data:image\//.test(g)||/(webp|svg|png|gif|jpg|jpeg|jfif|bmp|dpg|ico|heic|heif)$/i.test(m)?!0:!(/^data:/.test(g)||m)},le=200;function kt(c){return new Promise(g=>{if(!c.type||!Qe(c.type)){g("");return}const m=document.createElement("canvas");m.width=le,m.height=le,m.style.cssText=`position: fixed; left: 0; top: 0; width: ${le}px; height: ${le}px; z-index: 9999; display: none;`,document.body.appendChild(m);const b=m.getContext("2d"),I=new Image;if(I.onload=()=>{const{width:x,height:S}=I;let w=le,r=le,t=0,e=0;x>S?(r=S*(le/x),e=-(r-w)/2):(w=x*(le/S),t=-(w-r)/2),b.drawImage(I,t,e,w,r);const o=m.toDataURL();document.body.removeChild(m),g(o)},I.crossOrigin="anonymous",c.type.startsWith("image/svg+xml")){const x=new FileReader;x.addEventListener("load",()=>{x.result&&(I.src=x.result)}),x.readAsDataURL(c)}else I.src=window.URL.createObjectURL(c)})}var vt=E(47046),_t=function(g,m){return F.createElement($e.Z,(0,W.Z)({},g,{ref:m,icon:vt.Z}))},Re=F.forwardRef(_t),Pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},Ae=Pe,Zt=function(g,m){return F.createElement($e.Z,(0,W.Z)({},g,{ref:m,icon:Ae}))},Vt=F.forwardRef(Zt),qt=E(1208),yt=E(69814),bt=E(83062),Xt=F.forwardRef((c,g)=>{let{prefixCls:m,className:b,style:I,locale:x,listType:S,file:w,items:r,progress:t,iconRender:e,actionIconRender:o,itemRender:i,isImgUrl:n,showPreviewIcon:l,showRemoveIcon:h,showDownloadIcon:y,previewIcon:a,removeIcon:p,downloadIcon:$,onPreview:U,onDownload:O,onClose:M}=c;var B,Q;const{status:K}=w,[G,De]=F.useState(K);F.useEffect(()=>{K!=="removed"&&De(K)},[K]);const[ot,at]=F.useState(!1),re=F.useRef(null);F.useEffect(()=>(re.current=setTimeout(()=>{at(!0)},300),()=>{re.current&&clearTimeout(re.current)}),[]);const _=e(w);let ue=F.createElement("div",{className:`${m}-icon`},_);if(S==="picture"||S==="picture-card"||S==="picture-circle")if(G==="uploading"||!w.thumbUrl&&!w.url){const X=j()({[`${m}-list-item-thumbnail`]:!0,[`${m}-list-item-file`]:G!=="uploading"});ue=F.createElement("div",{className:X},_)}else{const X=n!=null&&n(w)?F.createElement("img",{src:w.thumbUrl||w.url,alt:w.name,className:`${m}-list-item-image`,crossOrigin:w.crossOrigin}):_,Se=j()({[`${m}-list-item-thumbnail`]:!0,[`${m}-list-item-file`]:n&&!n(w)});ue=F.createElement("a",{className:Se,onClick:ut=>U(w,ut),href:w.url||w.thumbUrl,target:"_blank",rel:"noopener noreferrer"},X)}const ke=j()(`${m}-list-item`,`${m}-list-item-${G}`),st=typeof w.linkProps=="string"?JSON.parse(w.linkProps):w.linkProps,he=h?o((typeof p=="function"?p(w):p)||F.createElement(Re,null),()=>M(w),m,x.removeFile):null,pe=y&&G==="done"?o((typeof $=="function"?$(w):$)||F.createElement(Vt,null),()=>O(w),m,x.downloadFile):null,ge=S!=="picture-card"&&S!=="picture-circle"&&F.createElement("span",{key:"download-delete",className:j()(`${m}-list-item-actions`,{picture:S==="picture"})},pe,he),Te=j()(`${m}-list-item-name`),R=w.url?[F.createElement("a",Object.assign({key:"view",target:"_blank",rel:"noopener noreferrer",className:Te,title:w.name},st,{href:w.url,onClick:X=>U(w,X)}),w.name),ge]:[F.createElement("span",{key:"view",className:Te,onClick:X=>U(w,X),title:w.name},w.name),ge],Z={pointerEvents:"none",opacity:.5},ee=l?F.createElement("a",{href:w.url||w.thumbUrl,target:"_blank",rel:"noopener noreferrer",style:w.url||w.thumbUrl?void 0:Z,onClick:X=>U(w,X),title:x.previewFile},typeof a=="function"?a(w):a||F.createElement(qt.Z,null)):null,Y=(S==="picture-card"||S==="picture-circle")&&G!=="uploading"&&F.createElement("span",{className:`${m}-list-item-actions`},ee,G==="done"&&pe,he),{getPrefixCls:ce}=F.useContext(Xe.E_),ze=ce(),lt=F.createElement("div",{className:ke},ue,R,Y,ot&&F.createElement(Ke.ZP,{motionName:`${ze}-fade`,visible:G==="uploading",motionDeadline:2e3},X=>{let{className:Se}=X;const ut="percent"in w?F.createElement(yt.Z,Object.assign({},t,{type:"line",percent:w.percent,"aria-label":w["aria-label"],"aria-labelledby":w["aria-labelledby"]})):null;return F.createElement("div",{className:j()(`${m}-list-item-progress`,Se)},ut)})),N=w.response&&typeof w.response=="string"?w.response:((B=w.error)===null||B===void 0?void 0:B.statusText)||((Q=w.error)===null||Q===void 0?void 0:Q.message)||x.uploadError,xe=G==="error"?F.createElement(bt.Z,{title:N,getPopupContainer:X=>X.parentNode},lt):lt;return F.createElement("div",{className:j()(`${m}-list-item-container`,b),style:I,ref:g},i?i(xe,w,r,{download:O.bind(null,w),preview:U.bind(null,w),remove:M.bind(null,w)}):xe)});const Gt=(c,g)=>{const{listType:m="text",previewFile:b=kt,onPreview:I,onDownload:x,onRemove:S,locale:w,iconRender:r,isImageUrl:t=Nt,prefixCls:e,items:o=[],showPreviewIcon:i=!0,showRemoveIcon:n=!0,showDownloadIcon:l=!1,removeIcon:h,previewIcon:y,downloadIcon:a,progress:p={size:[-1,2],showInfo:!1},appendAction:$,appendActionVisible:U=!0,itemRender:O,disabled:M}=c,B=(0,ln.Z)(),[Q,K]=F.useState(!1);F.useEffect(()=>{m!=="picture"&&m!=="picture-card"&&m!=="picture-circle"||(o||[]).forEach(R=>{typeof document=="undefined"||typeof window=="undefined"||!window.FileReader||!window.File||!(R.originFileObj instanceof File||R.originFileObj instanceof Blob)||R.thumbUrl!==void 0||(R.thumbUrl="",b&&b(R.originFileObj).then(Z=>{R.thumbUrl=Z||"",B()}))})},[m,o,b]),F.useEffect(()=>{K(!0)},[]);const G=(R,Z)=>{if(I)return Z==null||Z.preventDefault(),I(R)},De=R=>{typeof x=="function"?x(R):R.url&&window.open(R.url)},ot=R=>{S==null||S(R)},at=R=>{if(r)return r(R,m);const Z=R.status==="uploading",ee=t&&t(R)?F.createElement(jt,null):F.createElement(ye,null);let Y=Z?F.createElement(ht.Z,null):F.createElement(gt,null);return m==="picture"?Y=Z?F.createElement(ht.Z,null):ee:(m==="picture-card"||m==="picture-circle")&&(Y=Z?w.uploading:ee),Y},re=(R,Z,ee,Y)=>{const ce={type:"text",size:"small",title:Y,onClick:ze=>{Z(),(0,Je.l$)(R)&&R.props.onClick&&R.props.onClick(ze)},className:`${ee}-list-item-action`,disabled:M};if((0,Je.l$)(R)){const ze=(0,Je.Tm)(R,Object.assign(Object.assign({},R.props),{onClick:()=>{}}));return F.createElement(Oe.ZP,Object.assign({},ce,{icon:ze}))}return F.createElement(Oe.ZP,Object.assign({},ce),F.createElement("span",null,R))};F.useImperativeHandle(g,()=>({handlePreview:G,handleDownload:De}));const{getPrefixCls:_}=F.useContext(Xe.E_),ue=_("upload",e),ke=_(),st=j()({[`${ue}-list`]:!0,[`${ue}-list-${m}`]:!0}),he=(0,L.Z)(o.map(R=>({key:R.uid,file:R})));let ge={motionDeadline:2e3,motionName:`${ue}-${m==="picture-card"||m==="picture-circle"?"animate-inline":"animate"}`,keys:he,motionAppear:Q};const Te=F.useMemo(()=>{const R=Object.assign({},(0,Mt.ZP)(ke));return delete R.onAppearEnd,delete R.onEnterEnd,delete R.onLeaveEnd,R},[ke]);return m!=="picture-card"&&m!=="picture-circle"&&(ge=Object.assign(Object.assign({},Te),ge)),F.createElement("div",{className:st},F.createElement(Ke.V4,Object.assign({},ge,{component:!1}),R=>{let{key:Z,file:ee,className:Y,style:ce}=R;return F.createElement(Xt,{key:Z,locale:w,prefixCls:ue,className:Y,style:ce,file:ee,items:o,progress:p,listType:m,isImgUrl:t,showPreviewIcon:i,showRemoveIcon:n,showDownloadIcon:l,removeIcon:h,previewIcon:y,downloadIcon:a,iconRender:at,actionIconRender:re,itemRender:O,onPreview:G,onDownload:De,onClose:ot})}),$&&F.createElement(Ke.ZP,Object.assign({},ge,{visible:U,forceRender:!0}),R=>{let{className:Z,style:ee}=R;return(0,Je.Tm)($,Y=>({className:j()(Y.className,Z),style:Object.assign(Object.assign(Object.assign({},ee),{pointerEvents:Z?"none":void 0}),Y.style)}))}))};var Wt=F.forwardRef(Gt),be=E(14747),wt=E(33507),Kt=E(67968),et=E(45503),Jt=c=>{const{componentCls:g,iconCls:m}=c;return{[`${g}-wrapper`]:{[`${g}-drag`]:{position:"relative",width:"100%",height:"100%",textAlign:"center",background:c.colorFillAlter,border:`${c.lineWidth}px dashed ${c.colorBorder}`,borderRadius:c.borderRadiusLG,cursor:"pointer",transition:`border-color ${c.motionDurationSlow}`,[g]:{padding:`${c.padding}px 0`},[`${g}-btn`]:{display:"table",width:"100%",height:"100%",outline:"none"},[`${g}-drag-container`]:{display:"table-cell",verticalAlign:"middle"},[`&:not(${g}-disabled):hover`]:{borderColor:c.colorPrimaryHover},[`p${g}-drag-icon`]:{marginBottom:c.margin,[m]:{color:c.colorPrimary,fontSize:c.uploadThumbnailSize}},[`p${g}-text`]:{margin:`0 0 ${c.marginXXS}px`,color:c.colorTextHeading,fontSize:c.fontSizeLG},[`p${g}-hint`]:{color:c.colorTextDescription,fontSize:c.fontSize},[`&${g}-disabled`]:{cursor:"not-allowed",[`p${g}-drag-icon ${m},
            p${g}-text,
            p${g}-hint
          `]:{color:c.colorTextDisabled}}}}}},Ct=c=>{const{componentCls:g,antCls:m,iconCls:b,fontSize:I,lineHeight:x}=c,S=`${g}-list-item`,w=`${S}-actions`,r=`${S}-action`,t=Math.round(I*x);return{[`${g}-wrapper`]:{[`${g}-list`]:Object.assign(Object.assign({},(0,be.dF)()),{lineHeight:c.lineHeight,[S]:{position:"relative",height:c.lineHeight*I,marginTop:c.marginXS,fontSize:I,display:"flex",alignItems:"center",transition:`background-color ${c.motionDurationSlow}`,"&:hover":{backgroundColor:c.controlItemBgHover},[`${S}-name`]:Object.assign(Object.assign({},be.vS),{padding:`0 ${c.paddingXS}px`,lineHeight:x,flex:"auto",transition:`all ${c.motionDurationSlow}`}),[w]:{[r]:{opacity:0},[`${r}${m}-btn-sm`]:{height:t,border:0,lineHeight:1,"> span":{transform:"scale(1)"}},[`
              ${r}:focus,
              &.picture ${r}
            `]:{opacity:1},[b]:{color:c.actionsColor,transition:`all ${c.motionDurationSlow}`},[`&:hover ${b}`]:{color:c.colorText}},[`${g}-icon ${b}`]:{color:c.colorTextDescription,fontSize:I},[`${S}-progress`]:{position:"absolute",bottom:-c.uploadProgressOffset,width:"100%",paddingInlineStart:I+c.paddingXS,fontSize:I,lineHeight:0,pointerEvents:"none","> div":{margin:0}}},[`${S}:hover ${r}`]:{opacity:1,color:c.colorText},[`${S}-error`]:{color:c.colorError,[`${S}-name, ${g}-icon ${b}`]:{color:c.colorError},[w]:{[`${b}, ${b}:hover`]:{color:c.colorError},[r]:{opacity:1}}},[`${g}-list-item-container`]:{transition:`opacity ${c.motionDurationSlow}, height ${c.motionDurationSlow}`,"&::before":{display:"table",width:0,height:0,content:'""'}}})}}},xt=E(35780);const St=new xt.E4("uploadAnimateInlineIn",{from:{width:0,height:0,margin:0,padding:0,opacity:0}}),Le=new xt.E4("uploadAnimateInlineOut",{to:{width:0,height:0,margin:0,padding:0,opacity:0}});var Qt=c=>{const{componentCls:g}=c,m=`${g}-animate-inline`;return[{[`${g}-wrapper`]:{[`${m}-appear, ${m}-enter, ${m}-leave`]:{animationDuration:c.motionDurationSlow,animationTimingFunction:c.motionEaseInOutCirc,animationFillMode:"forwards"},[`${m}-appear, ${m}-enter`]:{animationName:St},[`${m}-leave`]:{animationName:Le}}},St,Le]},It=E(78589),en=E(10274);const we=c=>{const{componentCls:g,iconCls:m,uploadThumbnailSize:b,uploadProgressOffset:I}=c,x=`${g}-list`,S=`${x}-item`;return{[`${g}-wrapper`]:{[`
        ${x}${x}-picture,
        ${x}${x}-picture-card,
        ${x}${x}-picture-circle
      `]:{[S]:{position:"relative",height:b+c.lineWidth*2+c.paddingXS*2,padding:c.paddingXS,border:`${c.lineWidth}px ${c.lineType} ${c.colorBorder}`,borderRadius:c.borderRadiusLG,"&:hover":{background:"transparent"},[`${S}-thumbnail`]:Object.assign(Object.assign({},be.vS),{width:b,height:b,lineHeight:`${b+c.paddingSM}px`,textAlign:"center",flex:"none",[m]:{fontSize:c.fontSizeHeading2,color:c.colorPrimary},img:{display:"block",width:"100%",height:"100%",overflow:"hidden"}}),[`${S}-progress`]:{bottom:I,width:`calc(100% - ${c.paddingSM*2}px)`,marginTop:0,paddingInlineStart:b+c.paddingXS}},[`${S}-error`]:{borderColor:c.colorError,[`${S}-thumbnail ${m}`]:{[`svg path[fill='${It.iN[0]}']`]:{fill:c.colorErrorBg},[`svg path[fill='${It.iN.primary}']`]:{fill:c.colorError}}},[`${S}-uploading`]:{borderStyle:"dashed",[`${S}-name`]:{marginBottom:I}}},[`${x}${x}-picture-circle ${S}`]:{[`&, &::before, ${S}-thumbnail`]:{borderRadius:"50%"}}}}},tn=c=>{const{componentCls:g,iconCls:m,fontSizeLG:b,colorTextLightSolid:I}=c,x=`${g}-list`,S=`${x}-item`,w=c.uploadPicCardSize;return{[`
      ${g}-wrapper${g}-picture-card-wrapper,
      ${g}-wrapper${g}-picture-circle-wrapper
    `]:Object.assign(Object.assign({},(0,be.dF)()),{display:"inline-block",width:"100%",[`${g}${g}-select`]:{width:w,height:w,marginInlineEnd:c.marginXS,marginBottom:c.marginXS,textAlign:"center",verticalAlign:"top",backgroundColor:c.colorFillAlter,border:`${c.lineWidth}px dashed ${c.colorBorder}`,borderRadius:c.borderRadiusLG,cursor:"pointer",transition:`border-color ${c.motionDurationSlow}`,[`> ${g}`]:{display:"flex",alignItems:"center",justifyContent:"center",height:"100%",textAlign:"center"},[`&:not(${g}-disabled):hover`]:{borderColor:c.colorPrimary}},[`${x}${x}-picture-card, ${x}${x}-picture-circle`]:{[`${x}-item-container`]:{display:"inline-block",width:w,height:w,marginBlock:`0 ${c.marginXS}px`,marginInline:`0 ${c.marginXS}px`,verticalAlign:"top"},"&::after":{display:"none"},[S]:{height:"100%",margin:0,"&::before":{position:"absolute",zIndex:1,width:`calc(100% - ${c.paddingXS*2}px)`,height:`calc(100% - ${c.paddingXS*2}px)`,backgroundColor:c.colorBgMask,opacity:0,transition:`all ${c.motionDurationSlow}`,content:'" "'}},[`${S}:hover`]:{[`&::before, ${S}-actions`]:{opacity:1}},[`${S}-actions`]:{position:"absolute",insetInlineStart:0,zIndex:10,width:"100%",whiteSpace:"nowrap",textAlign:"center",opacity:0,transition:`all ${c.motionDurationSlow}`,[`${m}-eye, ${m}-download, ${m}-delete`]:{zIndex:10,width:b,margin:`0 ${c.marginXXS}px`,fontSize:b,cursor:"pointer",transition:`all ${c.motionDurationSlow}`,svg:{verticalAlign:"baseline"}}},[`${S}-actions, ${S}-actions:hover`]:{[`${m}-eye, ${m}-download, ${m}-delete`]:{color:new en.C(I).setAlpha(.65).toRgbString(),"&:hover":{color:I}}},[`${S}-thumbnail, ${S}-thumbnail img`]:{position:"static",display:"block",width:"100%",height:"100%",objectFit:"contain"},[`${S}-name`]:{display:"none",textAlign:"center"},[`${S}-file + ${S}-name`]:{position:"absolute",bottom:c.margin,display:"block",width:`calc(100% - ${c.paddingXS*2}px)`},[`${S}-uploading`]:{[`&${S}`]:{backgroundColor:c.colorFillAlter},[`&::before, ${m}-eye, ${m}-download, ${m}-delete`]:{display:"none"}},[`${S}-progress`]:{bottom:c.marginXL,width:`calc(100% - ${c.paddingXS*2}px)`,paddingInlineStart:0}}}),[`${g}-wrapper${g}-picture-circle-wrapper`]:{[`${g}${g}-select`]:{borderRadius:"50%"}}}};var tt=c=>{const{componentCls:g}=c;return{[`${g}-rtl`]:{direction:"rtl"}}};const nn=c=>{const{componentCls:g,colorTextDisabled:m}=c;return{[`${g}-wrapper`]:Object.assign(Object.assign({},(0,be.Wf)(c)),{[g]:{outline:0,"input[type='file']":{cursor:"pointer"}},[`${g}-select`]:{display:"inline-block"},[`${g}-disabled`]:{color:m,cursor:"not-allowed"}})}};var nt=(0,Kt.Z)("Upload",c=>{const{fontSizeHeading3:g,fontSize:m,lineHeight:b,lineWidth:I,controlHeightLG:x}=c,S=Math.round(m*b),w=(0,et.TS)(c,{uploadThumbnailSize:g*2,uploadProgressOffset:S/2+I,uploadPicCardSize:x*2.55});return[nn(w),Jt(w),we(w),tn(w),Ct(w),Qt(w),tt(w),(0,wt.Z)(w)]},c=>({actionsColor:c.colorTextDescription})),Ft=function(c,g,m,b){function I(x){return x instanceof m?x:new m(function(S){S(x)})}return new(m||(m=Promise))(function(x,S){function w(e){try{t(b.next(e))}catch(o){S(o)}}function r(e){try{t(b.throw(e))}catch(o){S(o)}}function t(e){e.done?x(e.value):I(e.value).then(w,r)}t((b=b.apply(c,g||[])).next())})};const Ce=`__LIST_IGNORE_${Date.now()}__`,rt=(c,g)=>{const{fileList:m,defaultFileList:b,onRemove:I,showUploadList:x=!0,listType:S="text",onPreview:w,onDownload:r,onChange:t,onDrop:e,previewFile:o,disabled:i,locale:n,iconRender:l,isImageUrl:h,progress:y,prefixCls:a,className:p,type:$="select",children:U,style:O,itemRender:M,maxCount:B,data:Q={},multiple:K=!1,action:G="",accept:De="",supportServerRender:ot=!0}=c,at=F.useContext(At.Z),re=i!=null?i:at,[_,ue]=(0,Pt.Z)(b||[],{value:m,postState:P=>P!=null?P:[]}),[ke,st]=F.useState("drop"),he=F.useRef(null);F.useMemo(()=>{const P=Date.now();(m||[]).forEach((z,k)=>{!z.uid&&!Object.isFrozen(z)&&(z.uid=`__AUTO__${P}_${k}__`)})},[m]);const pe=(P,z,k)=>{let D=(0,L.Z)(z),H=!1;B===1?D=D.slice(-1):B&&(H=!0,D=D.slice(0,B)),(0,qe.flushSync)(()=>{ue(D)});const J={file:P,fileList:D};k&&(J.event=k),(!H||D.some(je=>je.uid===P.uid))&&(0,qe.flushSync)(()=>{t==null||t(J)})},ge=(P,z)=>Ft(void 0,void 0,void 0,function*(){const{beforeUpload:k,transformFile:D}=c;let H=P;if(k){const J=yield k(P,z);if(J===!1)return!1;if(delete P[Ce],J===Ce)return Object.defineProperty(P,Ce,{value:!0,configurable:!0}),!1;typeof J=="object"&&J&&(H=J)}return D&&(H=yield D(H)),H}),Te=P=>{const z=P.filter(H=>!H.file[Ce]);if(!z.length)return;const k=z.map(H=>Ee(H.file));let D=(0,L.Z)(_);k.forEach(H=>{D=Ue(H,D)}),k.forEach((H,J)=>{let je=H;if(z[J].parsedFile)H.status="uploading";else{const{originFileObj:_e}=H;let Me;try{Me=new File([_e],_e.name,{type:_e.type})}catch($n){Me=new Blob([_e],{type:_e.type}),Me.name=_e.name,Me.lastModifiedDate=new Date,Me.lastModified=new Date().getTime()}Me.uid=H.uid,je=Me}pe(je,D)})},R=(P,z,k)=>{try{typeof P=="string"&&(P=JSON.parse(P))}catch(J){}if(!Ye(z,_))return;const D=Ee(z);D.status="done",D.percent=100,D.response=P,D.xhr=k;const H=Ue(D,_);pe(D,H)},Z=(P,z)=>{if(!Ye(z,_))return;const k=Ee(z);k.status="uploading",k.percent=P.percent;const D=Ue(k,_);pe(k,D,P)},ee=(P,z,k)=>{if(!Ye(k,_))return;const D=Ee(k);D.error=P,D.response=z,D.status="error";const H=Ue(D,_);pe(D,H)},Y=P=>{let z;Promise.resolve(typeof I=="function"?I(P):I).then(k=>{var D;if(k===!1)return;const H=Ht(P,_);H&&(z=Object.assign(Object.assign({},P),{status:"removed"}),_==null||_.forEach(J=>{const je=z.uid!==void 0?"uid":"name";J[je]===z[je]&&!Object.isFrozen(J)&&(J.status="removed")}),(D=he.current)===null||D===void 0||D.abort(z),pe(z,H))})},ce=P=>{st(P.type),P.type==="drop"&&(e==null||e(P))};F.useImperativeHandle(g,()=>({onBatchStart:Te,onSuccess:R,onProgress:Z,onError:ee,fileList:_,upload:he.current}));const{getPrefixCls:ze,direction:lt}=F.useContext(Xe.E_),N=ze("upload",a),xe=Object.assign(Object.assign({onBatchStart:Te,onError:ee,onProgress:Z,onSuccess:R},c),{data:Q,multiple:K,action:G,accept:De,supportServerRender:ot,prefixCls:N,disabled:re,beforeUpload:ge,onChange:void 0});delete xe.className,delete xe.style,(!U||re)&&delete xe.id;const[X,Se]=nt(N),[ut]=(0,Fe.Z)("Upload",Lt.Z.Upload),{showRemoveIcon:yn,showPreviewIcon:bn,showDownloadIcon:wn,removeIcon:Cn,previewIcon:xn,downloadIcon:Sn}=typeof x=="boolean"?{}:x,an=(P,z)=>x?F.createElement(Wt,{prefixCls:N,listType:S,items:_,previewFile:o,onPreview:w,onDownload:r,onRemove:Y,showRemoveIcon:!re&&yn,showPreviewIcon:bn,showDownloadIcon:wn,removeIcon:Cn,previewIcon:xn,downloadIcon:Sn,iconRender:l,locale:Object.assign(Object.assign({},ut),n),isImageUrl:h,progress:y,appendAction:P,appendActionVisible:z,itemRender:M,disabled:re}):P,sn={[`${N}-rtl`]:lt==="rtl"};if($==="drag"){const P=j()(N,{[`${N}-drag`]:!0,[`${N}-drag-uploading`]:_.some(z=>z.status==="uploading"),[`${N}-drag-hover`]:ke==="dragover",[`${N}-disabled`]:re,[`${N}-rtl`]:lt==="rtl"},Se);return X(F.createElement("span",{className:j()(`${N}-wrapper`,sn,p,Se)},F.createElement("div",{className:P,onDrop:ce,onDragOver:ce,onDragLeave:ce,style:O},F.createElement(ft,Object.assign({},xe,{ref:he,className:`${N}-btn`}),F.createElement("div",{className:`${N}-drag-container`},U))),an()))}const In=j()(N,`${N}-select`,{[`${N}-disabled`]:re}),vn=(P=>F.createElement("div",{className:In,style:P},F.createElement(ft,Object.assign({},xe,{ref:he}))))(U?void 0:{display:"none"});return X(S==="picture-card"||S==="picture-circle"?F.createElement("span",{className:j()(`${N}-wrapper`,{[`${N}-picture-card-wrapper`]:S==="picture-card",[`${N}-picture-circle-wrapper`]:S==="picture-circle"},sn,p,Se)},an(vn,!!U)):F.createElement("span",{className:j()(`${N}-wrapper`,sn,p,Se)},vn,an()))};var $t=F.forwardRef(rt),rn=function(c,g){var m={};for(var b in c)Object.prototype.hasOwnProperty.call(c,b)&&g.indexOf(b)<0&&(m[b]=c[b]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var I=0,b=Object.getOwnPropertySymbols(c);I<b.length;I++)g.indexOf(b[I])<0&&Object.prototype.propertyIsEnumerable.call(c,b[I])&&(m[b[I]]=c[b[I]]);return m},on=F.forwardRef((c,g)=>{var{style:m,height:b}=c,I=rn(c,["style","height"]);return F.createElement($t,Object.assign({ref:g},I,{type:"drag",style:Object.assign(Object.assign({},m),{height:b})}))});const it=$t;it.Dragger=on,it.LIST_IGNORE=Ce;var mn=it},65416:function(ct,de,E){"use strict";E.d(de,{ws:function(){return en}});var F=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,i){o.__proto__=i}||function(o,i){for(var n in i)i.hasOwnProperty(n)&&(o[n]=i[n])},r(t,e)};return function(t,e){r(t,e);function o(){this.constructor=t}t.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}}(),L;(function(r){r.InvalidFile="InvalidFile",r.InvalidToken="InvalidToken",r.InvalidMetadata="InvalidMetadata",r.InvalidChunkSize="InvalidChunkSize",r.InvalidCustomVars="InvalidCustomVars",r.NotAvailableUploadHost="NotAvailableUploadHost",r.ReadCacheFailed="ReadCacheFailed",r.InvalidCacheData="InvalidCacheData",r.WriteCacheFailed="WriteCacheFailed",r.RemoveCacheFailed="RemoveCacheFailed",r.GetCanvasContextFailed="GetCanvasContextFailed",r.UnsupportedFileType="UnsupportedFileType",r.FileReaderReadFailed="FileReaderReadFailed",r.NotAvailableXMLHttpRequest="NotAvailableXMLHttpRequest",r.InvalidProgressEventTarget="InvalidProgressEventTarget",r.RequestError="RequestError"})(L||(L={}));var A=function(){function r(t,e){this.name=t,this.message=e,this.stack=new Error().stack}return r}(),j=function(r){F(t,r);function t(e,o,i,n){var l=r.call(this,L.RequestError,i)||this;return l.code=e,l.reqId=o,l.isRequestError=!0,l.data=n,l}return t}(A),W=function(r){F(t,r);function t(e,o){return o===void 0&&(o=""),r.call(this,0,o,e)||this}return t}(j),oe=function(){function r(t,e){this.runTask=t,this.limit=e,this.aborted=!1,this.queue=[],this.processing=[]}return r.prototype.enqueue=function(t){var e=this;return new Promise(function(o,i){e.queue.push({task:t,resolve:o,reject:i}),e.check()})},r.prototype.run=function(t){var e=this;this.queue=this.queue.filter(function(o){return o!==t}),this.processing.push(t),this.runTask(t.task).then(function(){e.processing=e.processing.filter(function(o){return o!==t}),t.resolve(),e.check()},function(o){return t.reject(o)})},r.prototype.check=function(){var t=this;if(!this.aborted){var e=this.processing.length,o=this.limit-e;this.queue.slice(0,o).forEach(function(i){t.run(i)})}},r.prototype.abort=function(){this.queue=[],this.aborted=!0},r}(),me=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,i){o.__proto__=i}||function(o,i){for(var n in i)i.hasOwnProperty(n)&&(o[n]=i[n])},r(t,e)};return function(t,e){r(t,e);function o(){this.constructor=t}t.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}}(),ie=function(){return ie=Object.assign||function(r){for(var t,e=1,o=arguments.length;e<o;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},ie.apply(this,arguments)},te=function(){function r(){this.closed=!1}return r.prototype.unsubscribe=function(){this.closed||(this.closed=!0,this._unsubscribe&&this._unsubscribe())},r.prototype.add=function(t){this._unsubscribe=t},r}(),ae=function(r){me(t,r);function t(e,o,i){var n=r.call(this)||this;return n.isStopped=!1,e&&typeof e=="object"?n.destination=e:n.destination=ie(ie(ie({},e&&{next:e}),o&&{error:o}),i&&{complete:i}),n}return t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,r.prototype.unsubscribe.call(this))},t.prototype.next=function(e){!this.isStopped&&this.destination.next&&this.destination.next(e)},t.prototype.error=function(e){!this.isStopped&&this.destination.error&&(this.isStopped=!0,this.destination.error(e))},t.prototype.complete=function(e){!this.isStopped&&this.destination.complete&&(this.isStopped=!0,this.destination.complete(e))},t}(te),Ze=function(){function r(t){this._subscribe=t}return r.prototype.subscribe=function(t,e,o){var i=new ae(t,e,o);return i.add(this._subscribe(i)),i},r}();function He(r){if(r===null||typeof r=="undefined")return"";var t=r+"",e="",o,i,n=0;o=i=0,n=t.length;for(var l=0;l<n;l++){var h=t.charCodeAt(l),y=null;if(h<128)i++;else if(h>127&&h<2048)y=String.fromCharCode(h>>6|192,h&63|128);else if((h&63488^55296)>0)y=String.fromCharCode(h>>12|224,h>>6&63|128,h&63|128);else{if((h&64512^55296)>0)throw new RangeError("Unmatched trail surrogate at "+l);var a=t.charCodeAt(++l);if((a&64512^56320)>0)throw new RangeError("Unmatched lead surrogate at "+(l-1));h=((h&1023)<<10)+(a&1023)+65536,y=String.fromCharCode(h>>18|240,h>>12&63|128,h>>6&63|128,h&63|128)}y!==null&&(i>o&&(e+=t.slice(o,i)),e+=y,o=i=l+1)}return i>o&&(e+=t.slice(o,n)),e}function Ve(r){var t=[],e=0,o=0,i=0;for(r+="";e<r.length;){o=r.charCodeAt(e)&255,i=0,o<=191?(o=o&127,i=1):o<=223?(o=o&31,i=2):o<=239?(o=o&15,i=3):(o=o&7,i=4);for(var n=1;n<i;++n)o=o<<6|r.charCodeAt(n+e)&63;i===4?(o-=65536,t.push(String.fromCharCode(55296|o>>10&1023)),t.push(String.fromCharCode(56320|o&1023))):t.push(String.fromCharCode(o)),e+=i}return t.join("")}function ve(r){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e,o,i,n,l,h,y,a,p=0,$=0,U="",O=[];if(!r)return r;r=He(r+"");do e=r.charCodeAt(p++),o=r.charCodeAt(p++),i=r.charCodeAt(p++),a=e<<16|o<<8|i,n=a>>18&63,l=a>>12&63,h=a>>6&63,y=a&63,O[$++]=t.charAt(n)+t.charAt(l)+t.charAt(h)+t.charAt(y);while(p<r.length);switch(U=O.join(""),r.length%3){case 1:U=U.slice(0,-2)+"==";break;case 2:U=U.slice(0,-1)+"=";break}return U}function T(r){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e,o,i,n,l,h,y,a,p=0,$=0,U="",O=[];if(!r)return r;r+="";do n=t.indexOf(r.charAt(p++)),l=t.indexOf(r.charAt(p++)),h=t.indexOf(r.charAt(p++)),y=t.indexOf(r.charAt(p++)),a=n<<18|l<<12|h<<6|y,e=a>>16&255,o=a>>8&255,i=a&255,h===64?O[$++]=String.fromCharCode(e):y===64?O[$++]=String.fromCharCode(e,o):O[$++]=String.fromCharCode(e,o,i);while(p<r.length);return U=O.join(""),Ve(U)}function C(r){return r=ve(r),r.replace(/\//g,"_").replace(/\+/g,"-")}function v(r){return r=r.replace(/_/g,"/").replace(/-/g,"+"),T(r)}var u=E(8322),s=E.n(u),f=function(){return f=Object.assign||function(r){for(var t,e=1,o=arguments.length;e<o;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},f.apply(this,arguments)},d=function(r,t,e,o){function i(n){return n instanceof e?n:new e(function(l){l(n)})}return new(e||(e=Promise))(function(n,l){function h(p){try{a(o.next(p))}catch($){l($)}}function y(p){try{a(o.throw(p))}catch($){l($)}}function a(p){p.done?n(p.value):i(p.value).then(h,y)}a((o=o.apply(r,t||[])).next())})},q=function(r,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(a){return function(p){return y([a,p])}}function y(a){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(n=a[0]&2?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[a[0]&2,n.value]),a[0]){case 0:case 1:n=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){e.label=a[1];break}if(a[0]===6&&e.label<n[1]){e.label=n[1],n=a;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(a);break}n[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(p){a=[6,p],i=0}finally{o=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},V=Math.pow(1024,2);function ne(r,t){var e=t*V;if(e>r.size)e=r.size;else for(;r.size>e*1e4;)e*=2;for(var o=[],i=Math.ceil(r.size/e),n=0;n<i;n++){var l=r.slice(e*n,n===i-1?r.size:e*(n+1));o.push(l)}return o}function Be(r){return Object.keys(r).every(function(t){return t.indexOf("x-qn-meta-")===0})}function Ot(r){return Object.keys(r).every(function(t){return t.indexOf("x:")===0})}function Et(r){return r.reduce(function(t,e){return t+e},0)}function Ut(r,t,e){try{localStorage.setItem(r,JSON.stringify(t))}catch(o){e.warn(new A(L.WriteCacheFailed,"setLocalFileInfo failed: "+r))}}function Rt(r,t,e){var o=t==null?"_":"_key_"+t+"_";return"qiniu_js_sdk_upload_file_name_"+r+o+"size_"+e}function Ie(r,t){try{localStorage.removeItem(r)}catch(e){t.warn(new A(L.RemoveCacheFailed,"removeLocalFileInfo failed. key: "+r))}}function dt(r,t){var e=null;try{e=localStorage.getItem(r)}catch(i){t.warn(new A(L.ReadCacheFailed,"getLocalFileInfo failed. key: "+r))}if(e==null)return null;var o=null;try{o=JSON.parse(e)}catch(i){Ie(r,t),t.warn(new A(L.InvalidCacheData,"getLocalFileInfo failed to parse. key: "+r))}return o}function Ne(r){var t="UpToken "+r;return{Authorization:t}}function ft(r){var t=Ne(r);return f({"content-type":"application/octet-stream"},t)}function Pt(r){var t=Ne(r);return f({"content-type":"application/json"},t)}function qe(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)return new window.ActiveXObject("Microsoft.XMLHTTP");throw new A(L.NotAvailableXMLHttpRequest,"the current environment does not support.")}function Xe(r){return d(this,void 0,void 0,function(){var t,e;return q(this,function(o){switch(o.label){case 0:return[4,At(r)];case 1:return t=o.sent(),e=new(s()).ArrayBuffer,e.append(t),[2,e.end()]}})})}function At(r){return new Promise(function(t,e){var o=new FileReader;o.onload=function(i){if(i.target){var n=i.target.result;t(n)}else e(new A(L.InvalidProgressEventTarget,"progress event target is undefined"))},o.onerror=function(){e(new A(L.FileReaderReadFailed,"fileReader read failed"))},o.readAsArrayBuffer(r)})}function Fe(r,t){return new Promise(function(e,o){var i=qe();if(i.open(t.method,r),t.onCreate&&t.onCreate(i),t.headers){var n=t.headers;Object.keys(n).forEach(function(l){i.setRequestHeader(l,n[l])})}i.upload.addEventListener("progress",function(l){l.lengthComputable&&t.onProgress&&t.onProgress({loaded:l.loaded,total:l.total})}),i.onreadystatechange=function(){var l=i.responseText;if(i.readyState===4){var h=i.getResponseHeader("x-reqId")||"";if(i.status===0){o(new W("network error.",h));return}if(i.status!==200){var y="xhr request failed, code: "+i.status;l&&(y+=" response: "+l);var a=void 0;try{a=JSON.parse(l)}catch(p){}o(new j(i.status,h,y,a));return}try{e({data:JSON.parse(l),reqId:h})}catch(p){o(p)}}},i.send(t.body)})}function Lt(r){if(r&&r.match){var t=r.match(/(^https?)/);if(!t)return"";var e=t[1];return t=r.match(/^https?:\/\/([^:^/]*):(\d*)/),t?t[2]:e==="http"?"80":"443"}return""}function Dt(r){if(r&&r.match){var t=r.match(/^https?:\/\/([^:^/]*)/);return t?t[1]:""}return""}function Ge(r){if(!r)throw new A(L.InvalidToken,"invalid token.");var t=r.split(":");if(t.length===1)throw new A(L.InvalidToken,"invalid token segments.");var e=t.length>3?t[1]:t[0];if(!e)throw new A(L.InvalidToken,"missing assess key field.");var o=null;try{o=JSON.parse(v(t[t.length-1]))}catch(n){throw new A(L.InvalidToken,"token parse failed.")}if(o==null)throw new A(L.InvalidToken,"putPolicy is null.");if(o.scope==null)throw new A(L.InvalidToken,"scope field is null.");var i=o.scope.split(":")[0];if(!i)throw new A(L.InvalidToken,"resolve bucketName failed.");return{assessKey:e,bucketName:i,scope:o.scope}}function $e(r){var t=window.URL||window.webkitURL||window.mozURL;return t.createObjectURL(r)}var se,ye={z0:"z0",z1:"z1",z2:"z2",na0:"na0",as0:"as0",cnEast2:"cn-east-2"},ht=(se={},se[ye.z0]={srcUphost:["up.qiniup.com"],cdnUphost:["upload.qiniup.com"]},se[ye.z1]={srcUphost:["up-z1.qiniup.com"],cdnUphost:["upload-z1.qiniup.com"]},se[ye.z2]={srcUphost:["up-z2.qiniup.com"],cdnUphost:["upload-z2.qiniup.com"]},se[ye.na0]={srcUphost:["up-na0.qiniup.com"],cdnUphost:["upload-na0.qiniup.com"]},se[ye.as0]={srcUphost:["up-as0.qiniup.com"],cdnUphost:["upload-as0.qiniup.com"]},se[ye.cnEast2]={srcUphost:["up-cn-east-2.qiniup.com"],cdnUphost:["upload-cn-east-2.qiniup.com"]},se),Tt=E(17673),fe=function(){return fe=Object.assign||function(r){for(var t,e=1,o=arguments.length;e<o;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},fe.apply(this,arguments)},pt=function(r,t,e,o){function i(n){return n instanceof e?n:new e(function(l){l(n)})}return new(e||(e=Promise))(function(n,l){function h(p){try{a(o.next(p))}catch($){l($)}}function y(p){try{a(o.throw(p))}catch($){l($)}}function a(p){p.done?n(p.value):i(p.value).then(h,y)}a((o=o.apply(r,t||[])).next())})},gt=function(r,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(a){return function(p){return y([a,p])}}function y(a){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(n=a[0]&2?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[a[0]&2,n.value]),a[0]){case 0:case 1:n=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){e.label=a[1];break}if(a[0]===6&&e.label<n[1]){e.label=n[1],n=a;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(a);break}n[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(p){a=[6,p],i=0}finally{o=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};function mt(r,t,e){return pt(this,void 0,void 0,function(){var o,i;return gt(this,function(n){return o=(0,Tt.stringify)({ak:r,bucket:t}),i=e+"://api.qiniu.com/v2/query?"+o,[2,Fe(i,{method:"GET"})]})})}function We(r,t,e){var o=e.url,i=e.id;return o+"/buckets/"+r+"/objects/"+(t!=null?C(t):"~")+"/uploads/"+i}function zt(r,t,e,o){var i=o+"/buckets/"+t+"/objects/"+(e!=null?C(e):"~")+"/uploads";return Fe(i,{method:"POST",headers:Ne(r)})}function jt(r,t,e,o,i){var n=Ge(r).bucketName,l=We(n,t,o)+("/"+e),h=ft(r);return i.md5&&(h["Content-MD5"]=i.md5),Fe(l,fe(fe({},i),{method:"PUT",headers:h}))}function Ke(r,t,e,o){var i=Ge(r).bucketName,n=We(i,t,e);return Fe(n,fe(fe({},o),{method:"POST",headers:Pt(r)}))}function ln(r,t,e){var o=utils.getPutPolicy(r).bucketName,i=We(o,t,e);return utils.request(i,{method:"DELETE",headers:utils.getAuthHeaders(r)})}function Mt(r,t,e){return Fe(r,fe({method:"POST",body:t},e))}function Je(r,t){return pt(this,void 0,void 0,function(){var e,o,i,n,l;return gt(this,function(h){switch(h.label){case 0:return e=normalizeUploadConfig(r),o=e.upprotocol,e.uphost.length>0?[2,o+"://"+e.uphost[0]]:(i=utils.getPutPolicy(t),[4,mt(i.assessKey,i.bucketName,o)]);case 1:return n=h.sent(),l=n.data.up.acc.main,[2,o+"://"+l[0]]}})})}var Oe=function(){return Oe=Object.assign||function(r){for(var t,e=1,o=arguments.length;e<o;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},Oe.apply(this,arguments)},Ee=function(r,t,e,o){function i(n){return n instanceof e?n:new e(function(l){l(n)})}return new(e||(e=Promise))(function(n,l){function h(p){try{a(o.next(p))}catch($){l($)}}function y(p){try{a(o.throw(p))}catch($){l($)}}function a(p){p.done?n(p.value):i(p.value).then(h,y)}a((o=o.apply(r,t||[])).next())})},Ue=function(r,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(a){return function(p){return y([a,p])}}function y(a){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(n=a[0]&2?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[a[0]&2,n.value]),a[0]){case 0:case 1:n=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){e.label=a[1];break}if(a[0]===6&&e.label<n[1]){e.label=n[1],n=a;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(a);break}n[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(p){a=[6,p],i=0}finally{o=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ye=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var o=e.call(r),i,n=[],l;try{for(;(t===void 0||t-- >0)&&!(i=o.next()).done;)n.push(i.value)}catch(h){l={error:h}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(l)throw l.error}}return n},Ht=function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(Ye(arguments[t]));return r},Bt=4,Qe=[0,502,503,504,599],Nt=Ht(Qe,[612]),le=Math.pow(1024,3),kt=function(){function r(t,e,o,i){this.hostPool=o,this.logger=i,this.aborted=!1,this.retryCount=0,this.xhrList=[],this.config=t.config,i.info("config inited.",this.config),this.putExtra=Oe({fname:""},t.putExtra),i.info("putExtra inited.",this.putExtra),this.key=t.key,this.file=t.file,this.token=t.token,this.onData=e.onData,this.onError=e.onError,this.onComplete=e.onComplete;try{var n=Ge(this.token);this.bucketName=n.bucketName,this.assessKey=n.assessKey}catch(l){i.error("get putPolicy from token failed.",l),this.onError(l)}}return r.prototype.checkAndUpdateUploadHost=function(){return Ee(this,void 0,void 0,function(){var t;return Ue(this,function(e){switch(e.label){case 0:return this.logger.info("get available upload host."),[4,this.hostPool.getUp(this.assessKey,this.bucketName,this.config.upprotocol)];case 1:if(t=e.sent(),t==null)throw new A(L.NotAvailableUploadHost,"no available upload host.");return this.uploadHost!=null&&this.uploadHost.host!==t.host?this.logger.warn("host switches from "+this.uploadHost.host+" to "+t.host+"."):this.logger.info("use host "+t.host+"."),this.uploadHost=t,[2]}})})},r.prototype.checkAndUnfreezeHost=function(){this.logger.info("check unfreeze host."),this.uploadHost!=null&&this.uploadHost.isFrozen()&&(this.logger.warn(this.uploadHost.host+" will be unfrozen."),this.uploadHost.unfreeze())},r.prototype.checkAndFreezeHost=function(t){this.logger.info("check freeze host."),t instanceof j&&this.uploadHost!=null&&Qe.includes(t.code)&&(this.logger.warn(this.uploadHost.host+" will be temporarily frozen."),this.uploadHost.freeze())},r.prototype.handleError=function(t){this.logger.error(t.message),this.onError(t)},r.prototype.putFile=function(){return Ee(this,void 0,void 0,function(){var t,e,o,i;return Ue(this,function(n){switch(n.label){case 0:if(this.aborted=!1,this.putExtra.fname||(this.logger.info("use file.name as fname."),this.putExtra.fname=this.file.name),this.file.size>1e4*le)return this.handleError(new A(L.InvalidFile,"file size exceed maximum value 10000G")),[2];if(this.putExtra.customVars&&!Ot(this.putExtra.customVars))return this.handleError(new A(L.InvalidCustomVars,"customVars key should start width x:")),[2];if(this.putExtra.metadata&&!Be(this.putExtra.metadata))return this.handleError(new A(L.InvalidMetadata,"metadata key should start with x-qn-meta-")),[2];n.label=1;case 1:return n.trys.push([1,4,,5]),this.uploadAt=new Date().getTime(),[4,this.checkAndUpdateUploadHost()];case 2:return n.sent(),[4,this.run()];case 3:return t=n.sent(),this.onComplete(t.data),this.checkAndUnfreezeHost(),this.sendLog(t.reqId,200),[2];case 4:return e=n.sent(),this.aborted?(this.logger.warn("upload is aborted."),this.sendLog("",-2),[2]):(this.clear(),this.logger.error(e),e instanceof j&&(this.sendLog(e.reqId,e.code),this.checkAndFreezeHost(e),o=++this.retryCount<=this.config.retryCount,i=Nt.includes(e.code),i&&o)?(this.logger.warn("error auto retry: "+this.retryCount+"/"+this.config.retryCount+"."),this.putFile(),[2]):(this.onError(e),[3,5]));case 5:return[2]}})})},r.prototype.clear=function(){this.xhrList.forEach(function(t){t.onreadystatechange=null,t.abort()}),this.xhrList=[],this.logger.info("cleanup uploading xhr.")},r.prototype.stop=function(){this.logger.info("aborted."),this.clear(),this.aborted=!0},r.prototype.addXhr=function(t){this.xhrList.push(t)},r.prototype.sendLog=function(t,e){var o,i;this.logger.report({code:e,reqId:t,remoteIp:"",upType:"jssdk-h5",size:this.file.size,time:Math.floor(this.uploadAt/1e3),port:Lt((o=this.uploadHost)===null||o===void 0?void 0:o.getUrl()),host:Dt((i=this.uploadHost)===null||i===void 0?void 0:i.getUrl()),bytesSent:this.progress?this.progress.total.loaded:0,duration:Math.floor((new Date().getTime()-this.uploadAt)/1e3)})},r.prototype.getProgressInfoItem=function(t,e,o){return Oe({size:e,loaded:t,percent:t/e*100},o==null?{}:{fromCache:o})},r}(),vt=kt,_t=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,i){o.__proto__=i}||function(o,i){for(var n in i)i.hasOwnProperty(n)&&(o[n]=i[n])},r(t,e)};return function(t,e){r(t,e);function o(){this.constructor=t}t.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}}(),Re=function(){return Re=Object.assign||function(r){for(var t,e=1,o=arguments.length;e<o;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},Re.apply(this,arguments)},Pe=function(r,t,e,o){function i(n){return n instanceof e?n:new e(function(l){l(n)})}return new(e||(e=Promise))(function(n,l){function h(p){try{a(o.next(p))}catch($){l($)}}function y(p){try{a(o.throw(p))}catch($){l($)}}function a(p){p.done?n(p.value):i(p.value).then(h,y)}a((o=o.apply(r,t||[])).next())})},Ae=function(r,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(a){return function(p){return y([a,p])}}function y(a){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(n=a[0]&2?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[a[0]&2,n.value]),a[0]){case 0:case 1:n=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){e.label=a[1];break}if(a[0]===6&&e.label<n[1]){e.label=n[1],n=a;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(a);break}n[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(p){a=[6,p],i=0}finally{o=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}};function Zt(r){var t=/^[1-9]\d*$/;return t.test(String(r))}var Vt=function(r){_t(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Pe(this,void 0,void 0,function(){var e,o,i,n,l,h=this;return Ae(this,function(y){switch(y.label){case 0:if(this.logger.info("start run Resume."),!this.config.chunkSize||!Zt(this.config.chunkSize))throw new A(L.InvalidChunkSize,"chunkSize must be a positive integer");if(this.config.chunkSize>1024)throw new A(L.InvalidChunkSize,"chunkSize maximum value is 1024");return[4,this.initBeforeUploadChunks()];case 1:y.sent(),e=new oe(function(a){return Pe(h,void 0,void 0,function(){return Ae(this,function(p){switch(p.label){case 0:if(this.aborted)throw e.abort(),new Error("pool is aborted");return[4,this.uploadChunk(a)];case 1:return p.sent(),[2]}})})},this.config.concurrentRequestLimit),o=null,i=this.getLocalKey(),n=this.chunks.map(function(a,p){return e.enqueue({chunk:a,index:p})}),y.label=2;case 2:return y.trys.push([2,5,,6]),[4,Promise.all(n)];case 3:return y.sent(),[4,this.mkFileReq()];case 4:return o=y.sent(),[3,6];case 5:throw l=y.sent(),l instanceof j&&(l.code===612||l.code===400)&&Ie(i,this.logger),l;case 6:return Ie(i,this.logger),[2,o]}})})},t.prototype.uploadChunk=function(e){return Pe(this,void 0,void 0,function(){var o,i,n,l,h,y,a,p,$,U=this;return Ae(this,function(O){switch(O.label){case 0:return o=e.index,i=e.chunk,n=this.cachedUploadedList[o],this.logger.info("upload part "+o+", cache:",n),l=this.config.checkByMD5,h=function(){U.usedCacheList[o]=!0,U.updateChunkProgress(i.size,o),U.uploadedList[o]=n,U.updateLocalCache()},n&&!l?(h(),[2]):[4,Xe(i)];case 1:return y=O.sent(),this.logger.info("computed part md5.",y),n&&y===n.md5?(h(),[2]):(this.usedCacheList[o]=!1,a=function(M){U.updateChunkProgress(M.loaded,o)},p={body:i,md5:this.config.checkByServer?y:void 0,onProgress:a,onCreate:function(M){return U.addXhr(M)}},this.logger.info("part "+o+" start uploading."),[4,jt(this.token,this.key,e.index+1,this.getUploadInfo(),p)]);case 2:return $=O.sent(),this.logger.info("part "+o+" upload completed."),a({loaded:i.size,total:i.size}),this.uploadedList[o]={etag:$.data.etag,md5:$.data.md5,size:i.size},this.updateLocalCache(),[2]}})})},t.prototype.mkFileReq=function(){return Pe(this,void 0,void 0,function(){var e,o,i=this;return Ae(this,function(n){switch(n.label){case 0:return e=Re(Re(Re({parts:this.uploadedList.map(function(l,h){return{etag:l.etag,partNumber:h+1}}),fname:this.putExtra.fname},this.putExtra.mimeType&&{mimeType:this.putExtra.mimeType}),this.putExtra.customVars&&{customVars:this.putExtra.customVars}),this.putExtra.metadata&&{metadata:this.putExtra.metadata}),this.logger.info("parts upload completed, make file.",e),[4,Ke(this.token,this.key,this.getUploadInfo(),{onCreate:function(l){return i.addXhr(l)},body:JSON.stringify(e)})];case 1:return o=n.sent(),this.logger.info("finish Resume Progress."),this.updateMkFileProgress(1),[2,o]}})})},t.prototype.initBeforeUploadChunks=function(){return Pe(this,void 0,void 0,function(){var e,o,i;return Ae(this,function(n){switch(n.label){case 0:return this.uploadedList=[],this.usedCacheList=[],e=dt(this.getLocalKey(),this.logger),e?[3,2]:(this.logger.info("init upload parts from api."),[4,zt(this.token,this.bucketName,this.key,this.uploadHost.getUrl())]);case 1:return o=n.sent(),this.logger.info("initd upload parts of id: "+o.data.uploadId+"."),this.uploadId=o.data.uploadId,this.cachedUploadedList=[],[3,3];case 2:i=["resume upload parts from local cache,","total "+e.data.length+" part,","id is "+e.id+"."],this.logger.info(i.join(" ")),this.cachedUploadedList=e.data,this.uploadId=e.id,n.label=3;case 3:return this.chunks=ne(this.file,this.config.chunkSize),this.loaded={mkFileProgress:0,chunks:this.chunks.map(function(l){return 0})},this.notifyResumeProgress(),[2]}})})},t.prototype.getUploadInfo=function(){return{id:this.uploadId,url:this.uploadHost.getUrl()}},t.prototype.getLocalKey=function(){return Rt(this.file.name,this.key,this.file.size)},t.prototype.updateLocalCache=function(){Ut(this.getLocalKey(),{id:this.uploadId,data:this.uploadedList},this.logger)},t.prototype.updateChunkProgress=function(e,o){this.loaded.chunks[o]=e,this.notifyResumeProgress()},t.prototype.updateMkFileProgress=function(e){this.loaded.mkFileProgress=e,this.notifyResumeProgress()},t.prototype.notifyResumeProgress=function(){var e=this;this.progress={total:this.getProgressInfoItem(Et(this.loaded.chunks)+this.loaded.mkFileProgress,this.file.size+1),chunks:this.chunks.map(function(o,i){var n=e.usedCacheList[i];return e.getProgressInfoItem(e.loaded.chunks[i],o.size,n)}),uploadInfo:{id:this.uploadId,url:this.uploadHost.getUrl()}},this.onData(this.progress)},t}(vt),qt=Vt,yt=function(r,t,e,o){function i(n){return n instanceof e?n:new e(function(l){l(n)})}return new(e||(e=Promise))(function(n,l){function h(p){try{a(o.next(p))}catch($){l($)}}function y(p){try{a(o.throw(p))}catch($){l($)}}function a(p){p.done?n(p.value):i(p.value).then(h,y)}a((o=o.apply(r,t||[])).next())})},bt=function(r,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(a){return function(p){return y([a,p])}}function y(a){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(n=a[0]&2?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[a[0]&2,n.value]),a[0]){case 0:case 1:n=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){e.label=a[1];break}if(a[0]===6&&e.label<n[1]){e.label=n[1],n=a;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(a);break}n[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(p){a=[6,p],i=0}finally{o=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},un=function(){function r(){this.crc=-1,this.table=this.makeTable()}return r.prototype.makeTable=function(){for(var t=new Array,e=0;e<256;e++){for(var o=e,i=0;i<8;i++)o&1?o=o>>>1^3988292384:o>>>=1;t[e]=o}return t},r.prototype.append=function(t){for(var e=this.crc,o=0;o<t.byteLength;o++)e=e>>>8^this.table[(e^t[o])&255];this.crc=e},r.prototype.compute=function(){return(this.crc^-1)>>>0},r.prototype.readAsUint8Array=function(t){return yt(this,void 0,void 0,function(){var e;return bt(this,function(o){switch(o.label){case 0:return typeof t.arrayBuffer!="function"?[3,2]:(e=Uint8Array.bind,[4,t.arrayBuffer()]);case 1:return[2,new(e.apply(Uint8Array,[void 0,o.sent()]))];case 2:return[2,new Promise(function(i,n){var l=new FileReader;l.onload=function(){if(l.result==null){n();return}if(typeof l.result=="string"){n();return}i(new Uint8Array(l.result))},l.readAsArrayBuffer(t)})]}})})},r.prototype.file=function(t){return yt(this,void 0,void 0,function(){var e,o,i,n,l,h;return bt(this,function(y){switch(y.label){case 0:return t.size<=V?(e=this.append,[4,this.readAsUint8Array(t)]):[3,2];case 1:return e.apply(this,[y.sent()]),[2,this.compute()];case 2:o=Math.ceil(t.size/V),i=0,y.label=3;case 3:return i<o?(n=i*V,l=i===o-1?t.size:n+V,[4,this.readAsUint8Array(t.slice(n,l))]):[3,6];case 4:h=y.sent(),this.append(new Uint8Array(h)),y.label=5;case 5:return i++,[3,3];case 6:return[2,this.compute()]}})})},r.file=function(t){var e=new r;return e.file(t)},r}(),Xt=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,i){o.__proto__=i}||function(o,i){for(var n in i)i.hasOwnProperty(n)&&(o[n]=i[n])},r(t,e)};return function(t,e){r(t,e);function o(){this.constructor=t}t.prototype=e===null?Object.create(e):(o.prototype=e.prototype,new o)}}(),Gt=function(r,t,e,o){function i(n){return n instanceof e?n:new e(function(l){l(n)})}return new(e||(e=Promise))(function(n,l){function h(p){try{a(o.next(p))}catch($){l($)}}function y(p){try{a(o.throw(p))}catch($){l($)}}function a(p){p.done?n(p.value):i(p.value).then(h,y)}a((o=o.apply(r,t||[])).next())})},cn=function(r,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(a){return function(p){return y([a,p])}}function y(a){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(n=a[0]&2?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[a[0]&2,n.value]),a[0]){case 0:case 1:n=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){e.label=a[1];break}if(a[0]===6&&e.label<n[1]){e.label=n[1],n=a;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(a);break}n[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(p){a=[6,p],i=0}finally{o=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Wt=function(r){Xt(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.run=function(){return Gt(this,void 0,void 0,function(){var e,o,i,n,l=this;return cn(this,function(h){switch(h.label){case 0:return this.logger.info("start run Direct."),e=new FormData,e.append("file",this.file),e.append("token",this.token),this.key!=null&&e.append("key",this.key),e.append("fname",this.putExtra.fname),this.config.checkByServer?[4,un.file(this.file)]:[3,2];case 1:o=h.sent(),e.append("crc32",o.toString()),h.label=2;case 2:return this.putExtra.customVars&&(this.logger.info("init customVars."),i=this.putExtra.customVars,Object.keys(i).forEach(function(y){return e.append(y,i[y].toString())}),this.logger.info("customVars inited.")),this.logger.info("formData inited."),[4,Mt(this.uploadHost.getUrl(),e,{onProgress:function(y){l.updateDirectProgress(y.loaded,y.total)},onCreate:function(y){return l.addXhr(y)}})];case 3:return n=h.sent(),this.logger.info("Direct progress finish."),this.finishDirectProgress(),[2,n]}})})},t.prototype.updateDirectProgress=function(e,o){this.progress={total:this.getProgressInfoItem(e,o+1)},this.onData(this.progress)},t.prototype.finishDirectProgress=function(){if(!this.progress){this.logger.warn("progress is null."),this.progress={total:this.getProgressInfoItem(this.file.size,this.file.size)},this.onData(this.progress);return}var e=this.progress.total;this.progress={total:this.getProgressInfoItem(e.loaded+1,e.size)},this.onData(this.progress)},t}(vt),be=Wt;function wt(r,t,e){e===void 0&&(e=3);var o=qe();o.open("POST","https://uplog.qbox.me/log/3"),o.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o.setRequestHeader("Authorization",Ne(r).Authorization),o.onreadystatechange=function(){o.readyState===4&&o.status!==200&&e>0&&wt(r,t,e-1)};var i=[t.code||"",t.reqId||"",t.host||"",t.remoteIp||"",t.port||"",t.duration||"",t.time||"",t.bytesSent||"",t.upType||"",t.size||""].join(",");o.send(i)}var Kt=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var o=e.call(r),i,n=[],l;try{for(;(t===void 0||t-- >0)&&!(i=o.next()).done;)n.push(i.value)}catch(h){l={error:h}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(l)throw l.error}}return n},et=function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(Kt(arguments[t]));return r},dn=function(){function r(t,e,o,i){e===void 0&&(e=!0),o===void 0&&(o="OFF"),i===void 0&&(i="UPLOAD"),this.token=t,this.disableReport=e,this.level=o,this.prefix=i,this.id=++r.id}return r.prototype.getPrintPrefix=function(t){return"Qiniu-JS-SDK ["+t+"]["+this.prefix+"#"+this.id+"]:"},r.prototype.report=function(t,e){if(!this.disableReport)try{wt(this.token,t,e)}catch(o){this.warn(o)}},r.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=["INFO"];o.includes(this.level)&&console.log.apply(console,et([this.getPrintPrefix("INFO")],t))},r.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=["INFO","WARN"];o.includes(this.level)&&console.warn.apply(console,et([this.getPrintPrefix("WARN")],t))},r.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=["INFO","WARN","ERROR"];o.includes(this.level)&&console.error.apply(console,et([this.getPrintPrefix("ERROR")],t))},r.id=0,r}(),Jt=dn,Yt=function(r,t,e,o){function i(n){return n instanceof e?n:new e(function(l){l(n)})}return new(e||(e=Promise))(function(n,l){function h(p){try{a(o.next(p))}catch($){l($)}}function y(p){try{a(o.throw(p))}catch($){l($)}}function a(p){p.done?n(p.value):i(p.value).then(h,y)}a((o=o.apply(r,t||[])).next())})},Ct=function(r,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(a){return function(p){return y([a,p])}}function y(a){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(n=a[0]&2?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[a[0]&2,n.value]),a[0]){case 0:case 1:n=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){e.label=a[1];break}if(a[0]===6&&e.label<n[1]){e.label=n[1],n=a;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(a);break}n[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(p){a=[6,p],i=0}finally{o=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},xt=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var o=e.call(r),i,n=[],l;try{for(;(t===void 0||t-- >0)&&!(i=o.next()).done;)n.push(i.value)}catch(h){l={error:h}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(l)throw l.error}}return n},St=function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(xt(arguments[t]));return r},Le=new Map,fn=function(){function r(t,e){this.host=t,this.protocol=e}return r.prototype.isFrozen=function(){var t=new Date().getTime(),e=Le.get(this.host);return e!=null&&e>=t},r.prototype.freeze=function(t){t===void 0&&(t=20);var e=new Date().getTime()+t*1e3;Le.set(this.host,e)},r.prototype.unfreeze=function(){Le.delete(this.host)},r.prototype.getUrl=function(){return this.protocol+"://"+this.host},r.prototype.getUnfreezeTime=function(){return Le.get(this.host)},r}(),Qt=function(){function r(t){t===void 0&&(t=[]),this.initHosts=t,this.cachedHostsMap=new Map}return r.prototype.register=function(t,e,o,i){this.cachedHostsMap.set(t+"@"+e,o.map(function(n){return new fn(n,i)}))},r.prototype.refresh=function(t,e,o){var i,n,l,h;return Yt(this,void 0,void 0,function(){var y,a,p;return Ct(this,function($){switch($.label){case 0:return y=this.cachedHostsMap.get(t+"@"+e)||[],y.length>0?[2]:this.initHosts.length>0?(this.register(t,e,this.initHosts,o),[2]):[4,mt(t,e,o)];case 1:return a=$.sent(),(a==null?void 0:a.data)!=null&&(p=St(((n=(i=a.data.up)===null||i===void 0?void 0:i.acc)===null||n===void 0?void 0:n.main)||[],((h=(l=a.data.up)===null||l===void 0?void 0:l.acc)===null||h===void 0?void 0:h.backup)||[]),this.register(t,e,p,o)),[2]}})})},r.prototype.getUp=function(t,e,o){return Yt(this,void 0,void 0,function(){var i,n,l;return Ct(this,function(h){switch(h.label){case 0:return[4,this.refresh(t,e,o)];case 1:return h.sent(),i=this.cachedHostsMap.get(t+"@"+e)||[],i.length===0?[2,null]:(n=i.filter(function(y){return!y.isFrozen()}),n.length>0?[2,n[0]]:(l=i.slice().sort(function(y,a){return(y.getUnfreezeTime()||0)-(a.getUnfreezeTime()||0)}),[2,l[0]]))}})})},r}();function It(r,t,e,o){return r.config&&r.config.forceDirect?(o.info("ues forceDirect mode."),new be(r,t,e,o)):r.file.size>4*V?(o.info("file size over 4M, use Resume."),new qt(r,t,e,o)):(o.info("file size less or equal than 4M, use Direct."),new be(r,t,e,o))}function en(r,t,e,o,i){var n=new Jt(e,i==null?void 0:i.disableStatisticsReport,i==null?void 0:i.debugLogLevel,r.name),l={file:r,key:t,token:e,putExtra:o,config:nn(i,n)},h=new Qt(l.config.uphost);return new Ze(function(y){var a=It(l,{onData:function(p){return y.next(p)},onError:function(p){return y.error(p)},onComplete:function(p){return y.complete(p)}},h,n);return a.putFile(),a.stop.bind(a)})}var we=function(){return we=Object.assign||function(r){for(var t,e=1,o=arguments.length;e<o;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},we.apply(this,arguments)},tn=function(r,t){var e={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&t.indexOf(o)<0&&(e[o]=r[o]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,o=Object.getOwnPropertySymbols(r);i<o.length;i++)t.indexOf(o[i])<0&&Object.prototype.propertyIsEnumerable.call(r,o[i])&&(e[o[i]]=r[o[i]]);return e},hn=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var o=e.call(r),i,n=[],l;try{for(;(t===void 0||t-- >0)&&!(i=o.next()).done;)n.push(i.value)}catch(h){l={error:h}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(l)throw l.error}}return n},tt=function(){for(var r=[],t=0;t<arguments.length;t++)r=r.concat(hn(arguments[t]));return r};function nn(r,t){var e=we({},r),o=e.upprotocol,i=e.uphost,n=tn(e,["upprotocol","uphost"]),l=we({uphost:[],retryCount:3,checkByMD5:!1,forceDirect:!1,useCdnDomain:!0,checkByServer:!1,concurrentRequestLimit:3,chunkSize:Bt,upprotocol:"https",debugLogLevel:"OFF",disableStatisticsReport:!1},n);o&&(l.upprotocol=o.replace(/:$/,""));var h=[];if(t&&(r==null?void 0:r.uphost)!=null&&(r==null?void 0:r.region)!=null&&t.warn("do not use both the uphost and region config."),i)Array.isArray(i)?h.push.apply(h,tt(i)):h.push(i);else if(l!=null&&l.region){var y=ht[l==null?void 0:l.region];l.useCdnDomain?h.push.apply(h,tt(y.cdnUphost)):h.push.apply(h,tt(y.srcUphost))}return we(we({},l),{uphost:h.filter(Boolean)})}var nt=function(){return nt=Object.assign||function(r){for(var t,e=1,o=arguments.length;e<o;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},nt.apply(this,arguments)},Ft=function(r,t,e,o){function i(n){return n instanceof e?n:new e(function(l){l(n)})}return new(e||(e=Promise))(function(n,l){function h(p){try{a(o.next(p))}catch($){l($)}}function y(p){try{a(o.throw(p))}catch($){l($)}}function a(p){p.done?n(p.value):i(p.value).then(h,y)}a((o=o.apply(r,t||[])).next())})},Ce=function(r,t){var e={label:0,sent:function(){if(n[0]&1)throw n[1];return n[1]},trys:[],ops:[]},o,i,n,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(a){return function(p){return y([a,p])}}function y(a){if(o)throw new TypeError("Generator is already executing.");for(;e;)try{if(o=1,i&&(n=a[0]&2?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[a[0]&2,n.value]),a[0]){case 0:case 1:n=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,i=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(n=e.trys,!(n=n.length>0&&n[n.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!n||a[1]>n[0]&&a[1]<n[3])){e.label=a[1];break}if(a[0]===6&&e.label<n[1]){e.label=n[1],n=a;break}if(n&&e.label<n[2]){e.label=n[2],e.ops.push(a);break}n[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(p){a=[6,p],i=0}finally{o=n=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},rt={PNG:"image/png",JPEG:"image/jpeg",WEBP:"image/webp",BMP:"image/bmp"},pn=4,$t=Math.log(2),rn=Object.keys(rt).map(function(r){return rt[r]}),gn=rt.JPEG;function on(r){return rn.includes(r)}var it=function(){function r(t,e){this.file=t,this.config=e,this.config=nt({quality:.92,noCompressIfLarger:!1},this.config)}return r.prototype.process=function(){return Ft(this,void 0,void 0,function(){var t,e,o,i,n,l;return Ce(this,function(h){switch(h.label){case 0:if(this.outputType=this.file.type,t={},!on(this.file.type))throw new A(L.UnsupportedFileType,"unsupported file type: "+this.file.type);return[4,this.getOriginImage()];case 1:return e=h.sent(),[4,this.getCanvas(e)];case 2:return o=h.sent(),i=1,this.config.maxWidth&&(i=Math.min(1,this.config.maxWidth/o.width)),this.config.maxHeight&&(i=Math.min(1,i,this.config.maxHeight/o.height)),t.width=o.width,t.height=o.height,[4,this.doScale(o,i)];case 3:return n=h.sent(),l=this.toBlob(n),l.size>this.file.size&&this.config.noCompressIfLarger?[2,{dist:this.file,width:t.width,height:t.height}]:[2,{dist:l,width:n.width,height:n.height}]}})})},r.prototype.clear=function(t,e,o){this.outputType===gn?(t.fillStyle="#fff",t.fillRect(0,0,e,o)):t.clearRect(0,0,e,o)},r.prototype.getOriginImage=function(){var t=this;return new Promise(function(e,o){var i=$e(t.file),n=new Image;n.onload=function(){e(n)},n.onerror=function(){o("image load error")},n.src=i})},r.prototype.getCanvas=function(t){var e=this;return new Promise(function(o,i){var n=document.createElement("canvas"),l=n.getContext("2d");if(!l){i(new A(L.GetCanvasContextFailed,"context is null"));return}var h=t.width,y=t.height;n.height=y,n.width=h,e.clear(l,h,y),l.drawImage(t,0,0),o(n)})},r.prototype.doScale=function(t,e){return Ft(this,void 0,void 0,function(){var o,i,n,l,h,y,a,p,$,U,O,M,B,Q,K,G;return Ce(this,function(De){if(e===1)return[2,t];if(o=t.getContext("2d"),i=Math.min(pn,Math.ceil(1/e/$t)),n=Math.pow(e,1/i),l=document.createElement("canvas"),h=l.getContext("2d"),y=t.width,a=t.height,p=y,$=a,l.width=y,l.height=a,!h||!o)throw new A(L.GetCanvasContextFailed,"mctx or sctx can't be null");for(M=0;M<i;M++)B=y*n|0,Q=a*n|0,M===i-1&&(B=p*e,Q=$*e),M%2===0?(U=t,O=h):(U=l,O=o),this.clear(O,y,a),O.drawImage(U,0,0,y,a,0,0,B,Q),y=B,a=Q;return K=U===t?l:t,G=O.getImageData(0,0,y,a),K.width=y,K.height=a,O.putImageData(G,0,0),[2,K]})})},r.prototype.toBlob=function(t){var e=t.toDataURL(this.outputType,this.config.quality),o=atob(e.split(",")[1]).split("").map(function(n){return n.charCodeAt(0)}),i=new Blob([new Uint8Array(o)],{type:this.outputType});return i},r}(),mn=function(r,t){return new it(r,t).process()},c=null;function g(r,t){return r=encodeURIComponent(r),t.slice(t.length-1)!=="/"&&(t+="/"),t+r}function m(r,t,e){if(!/^\d$/.test(String(r.mode)))throw"mode should be number in imageView2";var o=r.mode,i=r.w,n=r.h,l=r.q,h=r.format;if(!i&&!n)throw"param w and h is empty in imageView2";var y="imageView2/"+encodeURIComponent(o);return y+=i?"/w/"+encodeURIComponent(i):"",y+=n?"/h/"+encodeURIComponent(n):"",y+=l?"/q/"+encodeURIComponent(l):"",y+=h?"/format/"+encodeURIComponent(h):"",t&&e&&(y=g(t,e)+"?"+y),y}function b(r,t,e){var o=r["auto-orient"],i=r.thumbnail,n=r.strip,l=r.gravity,h=r.crop,y=r.quality,a=r.rotate,p=r.format,$=r.blur,U="imageMogr2";return U+=o?"/auto-orient":"",U+=i?"/thumbnail/"+encodeURIComponent(i):"",U+=n?"/strip":"",U+=l?"/gravity/"+encodeURIComponent(l):"",U+=y?"/quality/"+encodeURIComponent(y):"",U+=h?"/crop/"+encodeURIComponent(h):"",U+=a?"/rotate/"+encodeURIComponent(a):"",U+=p?"/format/"+encodeURIComponent(p):"",U+=$?"/blur/"+encodeURIComponent($):"",t&&e&&(U=g(t,e)+"?"+U),U}function I(r,t,e){var o=r.mode;if(!o)throw"mode can't be empty in watermark";var i="watermark/"+o;if(o!==1&&o!==2)throw"mode is wrong";if(o===1){var n=r.image;if(!n)throw"image can't be empty in watermark";i+=n?"/image/"+urlSafeBase64Encode(n):""}if(o===2){var l=r.text,h=r.font,y=r.fontsize,a=r.fill;if(!l)throw"text can't be empty in watermark";i+=l?"/text/"+urlSafeBase64Encode(l):"",i+=h?"/font/"+urlSafeBase64Encode(h):"",i+=y?"/fontsize/"+y:"",i+=a?"/fill/"+urlSafeBase64Encode(a):""}var p=r.dissolve,$=r.gravity,U=r.dx,O=r.dy;return i+=p?"/dissolve/"+encodeURIComponent(p):"",i+=$?"/gravity/"+encodeURIComponent($):"",i+=U?"/dx/"+encodeURIComponent(U):"",i+=O?"/dy/"+encodeURIComponent(O):"",t&&e&&(i=g(t,e)+"?"+i),i}function x(r,t){var e=g(r,t)+"?imageInfo";return request(e,{method:"GET"})}function S(r,t){var e=g(r,t)+"?exif";return request(e,{method:"GET"})}function w(r,t,e){var o=Object.prototype.toString.call(r)==="[object Array]",i,n=!1,l="";if(o){for(var h=0,y=r.length;h<y;h++){if(i=r[h],!i.fop)throw"fop can't be empty in pipeline";switch(i.fop){case"watermark":l+=I(i)+"|";break;case"imageView2":l+=m(i)+"|";break;case"imageMogr2":l+=b(i)+"|";break;default:n=!0;break}if(n)throw"fop is wrong in pipeline"}if(t&&e){l=g(t,e)+"?"+l;var a=l.length;l.slice(a-1)==="|"&&(l=l.slice(0,a-1))}return l}throw"pipeline's first param should be array"}},8322:function(ct){(function(de){if(!0)ct.exports=de();else var E})(function(de){"use strict";var E=function(C,v){return C+v&4294967295},F=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function L(C,v,u,s,f,d){return v=E(E(v,C),E(s,d)),E(v<<f|v>>>32-f,u)}function A(C,v){var u=C[0],s=C[1],f=C[2],d=C[3];u+=(s&f|~s&d)+v[0]-680876936|0,u=(u<<7|u>>>25)+s|0,d+=(u&s|~u&f)+v[1]-389564586|0,d=(d<<12|d>>>20)+u|0,f+=(d&u|~d&s)+v[2]+606105819|0,f=(f<<17|f>>>15)+d|0,s+=(f&d|~f&u)+v[3]-1044525330|0,s=(s<<22|s>>>10)+f|0,u+=(s&f|~s&d)+v[4]-176418897|0,u=(u<<7|u>>>25)+s|0,d+=(u&s|~u&f)+v[5]+1200080426|0,d=(d<<12|d>>>20)+u|0,f+=(d&u|~d&s)+v[6]-1473231341|0,f=(f<<17|f>>>15)+d|0,s+=(f&d|~f&u)+v[7]-45705983|0,s=(s<<22|s>>>10)+f|0,u+=(s&f|~s&d)+v[8]+1770035416|0,u=(u<<7|u>>>25)+s|0,d+=(u&s|~u&f)+v[9]-1958414417|0,d=(d<<12|d>>>20)+u|0,f+=(d&u|~d&s)+v[10]-42063|0,f=(f<<17|f>>>15)+d|0,s+=(f&d|~f&u)+v[11]-1990404162|0,s=(s<<22|s>>>10)+f|0,u+=(s&f|~s&d)+v[12]+1804603682|0,u=(u<<7|u>>>25)+s|0,d+=(u&s|~u&f)+v[13]-40341101|0,d=(d<<12|d>>>20)+u|0,f+=(d&u|~d&s)+v[14]-1502002290|0,f=(f<<17|f>>>15)+d|0,s+=(f&d|~f&u)+v[15]+1236535329|0,s=(s<<22|s>>>10)+f|0,u+=(s&d|f&~d)+v[1]-165796510|0,u=(u<<5|u>>>27)+s|0,d+=(u&f|s&~f)+v[6]-1069501632|0,d=(d<<9|d>>>23)+u|0,f+=(d&s|u&~s)+v[11]+643717713|0,f=(f<<14|f>>>18)+d|0,s+=(f&u|d&~u)+v[0]-373897302|0,s=(s<<20|s>>>12)+f|0,u+=(s&d|f&~d)+v[5]-701558691|0,u=(u<<5|u>>>27)+s|0,d+=(u&f|s&~f)+v[10]+38016083|0,d=(d<<9|d>>>23)+u|0,f+=(d&s|u&~s)+v[15]-660478335|0,f=(f<<14|f>>>18)+d|0,s+=(f&u|d&~u)+v[4]-405537848|0,s=(s<<20|s>>>12)+f|0,u+=(s&d|f&~d)+v[9]+568446438|0,u=(u<<5|u>>>27)+s|0,d+=(u&f|s&~f)+v[14]-1019803690|0,d=(d<<9|d>>>23)+u|0,f+=(d&s|u&~s)+v[3]-187363961|0,f=(f<<14|f>>>18)+d|0,s+=(f&u|d&~u)+v[8]+1163531501|0,s=(s<<20|s>>>12)+f|0,u+=(s&d|f&~d)+v[13]-1444681467|0,u=(u<<5|u>>>27)+s|0,d+=(u&f|s&~f)+v[2]-51403784|0,d=(d<<9|d>>>23)+u|0,f+=(d&s|u&~s)+v[7]+1735328473|0,f=(f<<14|f>>>18)+d|0,s+=(f&u|d&~u)+v[12]-1926607734|0,s=(s<<20|s>>>12)+f|0,u+=(s^f^d)+v[5]-378558|0,u=(u<<4|u>>>28)+s|0,d+=(u^s^f)+v[8]-2022574463|0,d=(d<<11|d>>>21)+u|0,f+=(d^u^s)+v[11]+1839030562|0,f=(f<<16|f>>>16)+d|0,s+=(f^d^u)+v[14]-35309556|0,s=(s<<23|s>>>9)+f|0,u+=(s^f^d)+v[1]-1530992060|0,u=(u<<4|u>>>28)+s|0,d+=(u^s^f)+v[4]+1272893353|0,d=(d<<11|d>>>21)+u|0,f+=(d^u^s)+v[7]-155497632|0,f=(f<<16|f>>>16)+d|0,s+=(f^d^u)+v[10]-1094730640|0,s=(s<<23|s>>>9)+f|0,u+=(s^f^d)+v[13]+681279174|0,u=(u<<4|u>>>28)+s|0,d+=(u^s^f)+v[0]-358537222|0,d=(d<<11|d>>>21)+u|0,f+=(d^u^s)+v[3]-722521979|0,f=(f<<16|f>>>16)+d|0,s+=(f^d^u)+v[6]+76029189|0,s=(s<<23|s>>>9)+f|0,u+=(s^f^d)+v[9]-640364487|0,u=(u<<4|u>>>28)+s|0,d+=(u^s^f)+v[12]-421815835|0,d=(d<<11|d>>>21)+u|0,f+=(d^u^s)+v[15]+530742520|0,f=(f<<16|f>>>16)+d|0,s+=(f^d^u)+v[2]-995338651|0,s=(s<<23|s>>>9)+f|0,u+=(f^(s|~d))+v[0]-198630844|0,u=(u<<6|u>>>26)+s|0,d+=(s^(u|~f))+v[7]+1126891415|0,d=(d<<10|d>>>22)+u|0,f+=(u^(d|~s))+v[14]-1416354905|0,f=(f<<15|f>>>17)+d|0,s+=(d^(f|~u))+v[5]-57434055|0,s=(s<<21|s>>>11)+f|0,u+=(f^(s|~d))+v[12]+1700485571|0,u=(u<<6|u>>>26)+s|0,d+=(s^(u|~f))+v[3]-1894986606|0,d=(d<<10|d>>>22)+u|0,f+=(u^(d|~s))+v[10]-1051523|0,f=(f<<15|f>>>17)+d|0,s+=(d^(f|~u))+v[1]-2054922799|0,s=(s<<21|s>>>11)+f|0,u+=(f^(s|~d))+v[8]+1873313359|0,u=(u<<6|u>>>26)+s|0,d+=(s^(u|~f))+v[15]-30611744|0,d=(d<<10|d>>>22)+u|0,f+=(u^(d|~s))+v[6]-1560198380|0,f=(f<<15|f>>>17)+d|0,s+=(d^(f|~u))+v[13]+1309151649|0,s=(s<<21|s>>>11)+f|0,u+=(f^(s|~d))+v[4]-145523070|0,u=(u<<6|u>>>26)+s|0,d+=(s^(u|~f))+v[11]-1120210379|0,d=(d<<10|d>>>22)+u|0,f+=(u^(d|~s))+v[2]+718787259|0,f=(f<<15|f>>>17)+d|0,s+=(d^(f|~u))+v[9]-343485551|0,s=(s<<21|s>>>11)+f|0,C[0]=u+C[0]|0,C[1]=s+C[1]|0,C[2]=f+C[2]|0,C[3]=d+C[3]|0}function j(C){var v=[],u;for(u=0;u<64;u+=4)v[u>>2]=C.charCodeAt(u)+(C.charCodeAt(u+1)<<8)+(C.charCodeAt(u+2)<<16)+(C.charCodeAt(u+3)<<24);return v}function W(C){var v=[],u;for(u=0;u<64;u+=4)v[u>>2]=C[u]+(C[u+1]<<8)+(C[u+2]<<16)+(C[u+3]<<24);return v}function oe(C){var v=C.length,u=[1732584193,-271733879,-1732584194,271733878],s,f,d,q,V,ne;for(s=64;s<=v;s+=64)A(u,j(C.substring(s-64,s)));for(C=C.substring(s-64),f=C.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s=0;s<f;s+=1)d[s>>2]|=C.charCodeAt(s)<<(s%4<<3);if(d[s>>2]|=128<<(s%4<<3),s>55)for(A(u,d),s=0;s<16;s+=1)d[s]=0;return q=v*8,q=q.toString(16).match(/(.*?)(.{0,8})$/),V=parseInt(q[2],16),ne=parseInt(q[1],16)||0,d[14]=V,d[15]=ne,A(u,d),u}function me(C){var v=C.length,u=[1732584193,-271733879,-1732584194,271733878],s,f,d,q,V,ne;for(s=64;s<=v;s+=64)A(u,W(C.subarray(s-64,s)));for(C=s-64<v?C.subarray(s-64):new Uint8Array(0),f=C.length,d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],s=0;s<f;s+=1)d[s>>2]|=C[s]<<(s%4<<3);if(d[s>>2]|=128<<(s%4<<3),s>55)for(A(u,d),s=0;s<16;s+=1)d[s]=0;return q=v*8,q=q.toString(16).match(/(.*?)(.{0,8})$/),V=parseInt(q[2],16),ne=parseInt(q[1],16)||0,d[14]=V,d[15]=ne,A(u,d),u}function ie(C){var v="",u;for(u=0;u<4;u+=1)v+=F[C>>u*8+4&15]+F[C>>u*8&15];return v}function te(C){var v;for(v=0;v<C.length;v+=1)C[v]=ie(C[v]);return C.join("")}te(oe("hello"))!=="5d41402abc4b2a76b9719d911017c592"&&(E=function(C,v){var u=(C&65535)+(v&65535),s=(C>>16)+(v>>16)+(u>>16);return s<<16|u&65535}),typeof ArrayBuffer!="undefined"&&!ArrayBuffer.prototype.slice&&function(){function C(v,u){return v=v|0||0,v<0?Math.max(v+u,0):Math.min(v,u)}ArrayBuffer.prototype.slice=function(v,u){var s=this.byteLength,f=C(v,s),d=s,q,V,ne,Be;return u!==de&&(d=C(u,s)),f>d?new ArrayBuffer(0):(q=d-f,V=new ArrayBuffer(q),ne=new Uint8Array(V),Be=new Uint8Array(this,f,q),ne.set(Be),V)}}();function ae(C){return/[\u0080-\uFFFF]/.test(C)&&(C=unescape(encodeURIComponent(C))),C}function Ze(C,v){var u=C.length,s=new ArrayBuffer(u),f=new Uint8Array(s),d;for(d=0;d<u;d+=1)f[d]=C.charCodeAt(d);return v?f:s}function He(C){return String.fromCharCode.apply(null,new Uint8Array(C))}function Ve(C,v,u){var s=new Uint8Array(C.byteLength+v.byteLength);return s.set(new Uint8Array(C)),s.set(new Uint8Array(v),C.byteLength),u?s:s.buffer}function ve(C){var v=[],u=C.length,s;for(s=0;s<u-1;s+=2)v.push(parseInt(C.substr(s,2),16));return String.fromCharCode.apply(String,v)}function T(){this.reset()}return T.prototype.append=function(C){return this.appendBinary(ae(C)),this},T.prototype.appendBinary=function(C){this._buff+=C,this._length+=C.length;var v=this._buff.length,u;for(u=64;u<=v;u+=64)A(this._hash,j(this._buff.substring(u-64,u)));return this._buff=this._buff.substring(u-64),this},T.prototype.end=function(C){var v=this._buff,u=v.length,s,f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],d;for(s=0;s<u;s+=1)f[s>>2]|=v.charCodeAt(s)<<(s%4<<3);return this._finish(f,u),d=te(this._hash),C&&(d=ve(d)),this.reset(),d},T.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},T.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},T.prototype.setState=function(C){return this._buff=C.buff,this._length=C.length,this._hash=C.hash,this},T.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},T.prototype._finish=function(C,v){var u=v,s,f,d;if(C[u>>2]|=128<<(u%4<<3),u>55)for(A(this._hash,C),u=0;u<16;u+=1)C[u]=0;s=this._length*8,s=s.toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(s[2],16),d=parseInt(s[1],16)||0,C[14]=f,C[15]=d,A(this._hash,C)},T.hash=function(C,v){return T.hashBinary(ae(C),v)},T.hashBinary=function(C,v){var u=oe(C),s=te(u);return v?ve(s):s},T.ArrayBuffer=function(){this.reset()},T.ArrayBuffer.prototype.append=function(C){var v=Ve(this._buff.buffer,C,!0),u=v.length,s;for(this._length+=C.byteLength,s=64;s<=u;s+=64)A(this._hash,W(v.subarray(s-64,s)));return this._buff=s-64<u?new Uint8Array(v.buffer.slice(s-64)):new Uint8Array(0),this},T.ArrayBuffer.prototype.end=function(C){var v=this._buff,u=v.length,s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],f,d;for(f=0;f<u;f+=1)s[f>>2]|=v[f]<<(f%4<<3);return this._finish(s,u),d=te(this._hash),C&&(d=ve(d)),this.reset(),d},T.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},T.ArrayBuffer.prototype.getState=function(){var C=T.prototype.getState.call(this);return C.buff=He(C.buff),C},T.ArrayBuffer.prototype.setState=function(C){return C.buff=Ze(C.buff,!0),T.prototype.setState.call(this,C)},T.ArrayBuffer.prototype.destroy=T.prototype.destroy,T.ArrayBuffer.prototype._finish=T.prototype._finish,T.ArrayBuffer.hash=function(C,v){var u=me(new Uint8Array(C)),s=te(u);return v?ve(s):s},T})}}]);
